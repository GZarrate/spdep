<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute SAR generating operator — invIrM • spdep</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Compute SAR generating operator — invIrM" />

<meta property="og:description" content="Computes the matrix used for generating simultaneous autoregressive random variables, for a given value of rho, a neighbours list object or a matrix, a chosen coding scheme style, and optionally a list of general weights corresponding to neighbours." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute SAR generating operator</h1>
    
    <div class="hidden name"><code>invIrM.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes the matrix used for generating simultaneous autoregressive random variables, for a given value of rho, a neighbours list object or a matrix, a chosen coding scheme style, and optionally a list of general weights corresponding to neighbours.</p>
    
    </div>

    <pre class="usage"><span class='fu'>invIrM</span>(<span class='no'>neighbours</span>, <span class='no'>rho</span>, <span class='kw'>glist</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>style</span><span class='kw'>=</span><span class='st'>"W"</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"solve"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>invIrW</span>(<span class='no'>x</span>, <span class='no'>rho</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"solve"</span>, <span class='kw'>feasible</span><span class='kw'>=</span><span class='kw'>NULL</span>)
<span class='fu'>powerWeights</span>(<span class='no'>W</span>, <span class='no'>rho</span>, <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>250</span>, <span class='no'>X</span>, <span class='kw'>tol</span><span class='kw'>=</span><span class='no'>.Machine</span>$<span class='no'>double.eps</span>^(<span class='fl'>3</span>/<span class='fl'>5</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>neighbours</th>
      <td><p>an object of class <code>nb</code></p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>autoregressive parameter</p></td>
    </tr>
    <tr>
      <th>glist</th>
      <td><p>list of general weights corresponding to neighbours</p></td>
    </tr>
    <tr>
      <th>style</th>
      <td><p><code>style</code> can take values W, B, C, and S</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>default <code>solve</code>, can also take value <code>chol</code></p></td>
    </tr>
    <tr>
      <th>feasible</th>
      <td><p>if NULL, the given value of rho is checked to see if it lies within its feasible range, if TRUE, the test is not conducted</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>either a <code>listw</code> object from for example <code>nb2listw</code>, or a square spatial weights matrix, optionally a sparse matrix</p></td>
    </tr>
    <tr>
      <th>W</th>
      <td><p>A spatial weights matrix (either a dense matrix or a CsparseMatrix)</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>Power series maximum limit</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>A numerical matrix</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance for convergence of power series</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>invIrW</code> function generates the full weights matrix V, checks that rho lies in its feasible range between 1/min(eigen(V)) and 1/max(eigen(V)), and returns the nxn inverted matrix $$(I - \rho V)^{-1}$$. With method=&#8220;chol&#8221; (only for a listw object), Cholesky decomposition is used, thanks to contributed code by Markus Reder and Werner Mueller.</p>
<p>Note that, in some situations in simulation, it may matter that the random vector from <code>rnorm</code> or similar will not be exactly N(0, 1), and it will also contain random amounts of spatial autocorrelection itself, which will mix with the spatial autocorrelection injected by the process operator $$(I - \rho V)^{-1}$$. In addition, it will not follow the stipulated distribution exactly either, so that several steps may be needed to scale the random vector, to remove artefacts coming from its deviance from distributional parameters, and to remove random spatial autocorrelation - see the examples below. Thanks to Rune Østergaard Pedersen for bring up this question.</p>
<p>The <code>powerWeights</code> function uses power series summation to cumulate the product $$(I - \rho V)^{-1} \%*\% X$$ from $$(I + \rho V + (\rho V)^2 + \dots) \%*\% X$$, which can be done by storing only sparse V and several matrices of the same dimensions as X. This makes it possible to handle larger spatial weights matrices, but is sensitive to the power weights order and the tolerance arguments when the spatial coefficient is close to its bounds, leading to incorrect estimates of the implied inverse matrix.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An nxn matrix with a "call" attribute; the <code>powerWeights</code> function returns a matrix of the same dimensions as X which has been multipled by the power series equivalent of the dense matrix $$(I - \rho V)^{-1}$$.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Before version 0.6-10, <code>powerWeights</code> only worked correctly for positive rho, with differences from true values increasing as rho approached -1, and exploding between -1 and the true negative bound.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Tiefelsdorf, M., Griffith, D. A., Boots, B. 1999 A variance-stabilizing coding scheme for spatial link matrices, Environment and Planning A, 31, pp. 165-180; Tiefelsdorf, M. 2000 Modelling spatial processes, Lecture notes in earth sciences, Springer, p. 76; Haining, R. 1990 Spatial data analysis in the social and environmental sciences, Cambridge University Press, p. 117; Cliff, A. D., Ord, J. K. 1981 Spatial processes, Pion, p. 152; Reder, M. and Mueller, W. (2007) An Improvement of the invIrM Routine of the Geostatistical R-package spdep by Cholesky Inversion, Statistical Projects, LV No: 238.205, SS 2006, Department of Applied Statistics, Johannes Kepler University, Linz</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='nb2listw.html'>nb2listw</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>nb7rt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span>(<span class='fl'>7</span>, <span class='fl'>7</span>, <span class='kw'>torus</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>lw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>nb7rt</span>, <span class='kw'>style</span><span class='kw'>=</span><span class='st'>"W"</span>)
<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eigenw.html'>eigenw</a></span>(<span class='no'>lw</span>)
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>sample</span>(<span class='fu'>rnorm</span>(<span class='fl'>500</span>*<span class='fu'>length</span>(<span class='no'>nb7rt</span>))), <span class='kw'>nrow</span><span class='kw'>=</span><span class='fu'>length</span>(<span class='no'>nb7rt</span>))
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Only needed in some simulation settings where the input and</span>
<span class='co'># output distributions must agree in all but autocorrelation</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='no'>x</span>, <span class='fl'>2</span>, <span class='no'>scale</span>)
<span class='no'>st</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>shapiro.test</span>(<span class='no'>x</span>)$<span class='no'>p.value</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='no'>x</span>[, (<span class='no'>st</span> <span class='kw'>&gt;</span> <span class='fl'>0.2</span> <span class='kw'>&amp;</span> <span class='no'>st</span> <span class='kw'>&lt;</span> <span class='fl'>0.8</span>)]
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>v</span>) <span class='fu'>residuals</span>(<span class='fu'><a href='spautolm.html'>spautolm</a></span>(<span class='no'>v</span> ~ <span class='fl'>1</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>lw</span>,
 <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"eigen"</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>e</span>, <span class='kw'>fdHess</span><span class='kw'>=</span><span class='fl'>FALSE</span>))))
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='no'>x</span>, <span class='fl'>2</span>, <span class='no'>scale</span>)
}
<span class='no'>res0</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.0</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>var</span>(<span class='no'>x</span>)/<span class='fu'>length</span>(<span class='no'>x</span>))
<span class='no'>res2</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.2</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>var</span>(<span class='no'>x</span>)/<span class='fu'>length</span>(<span class='no'>x</span>))
<span class='no'>res4</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.4</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>var</span>(<span class='no'>x</span>)/<span class='fu'>length</span>(<span class='no'>x</span>))
<span class='no'>res6</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.6</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>var</span>(<span class='no'>x</span>)/<span class='fu'>length</span>(<span class='no'>x</span>))
<span class='no'>res8</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.8</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>var</span>(<span class='no'>x</span>)/<span class='fu'>length</span>(<span class='no'>x</span>))
<span class='no'>res9</span> <span class='kw'>&lt;-</span> <span class='fu'>apply</span>(<span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>,
 <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>var</span>(<span class='no'>x</span>)/<span class='fu'>length</span>(<span class='no'>x</span>))
<span class='fu'>plot</span>(<span class='fu'>density</span>(<span class='no'>res9</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>, <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'>c</span>(-<span class='fl'>0.01</span>, <span class='fu'>max</span>(<span class='fu'>density</span>(<span class='no'>res9</span>)$<span class='no'>x</span>)),
  <span class='kw'>ylim</span><span class='kw'>=</span><span class='fu'>range</span>(<span class='fu'>density</span>(<span class='no'>res0</span>)$<span class='no'>y</span>),
  <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"estimated variance of the mean"</span>,
  <span class='kw'>main</span><span class='kw'>=</span><span class='fu'>expression</span>(<span class='fu'>paste</span>(<span class='st'>"Effects of spatial autocorrelation for different "</span>,
    <span class='no'>rho</span>, <span class='st'>" values"</span>)))</div><div class='input'><span class='fu'>lines</span>(<span class='fu'>density</span>(<span class='no'>res0</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"black"</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='fu'>density</span>(<span class='no'>res2</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"brown"</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='fu'>density</span>(<span class='no'>res4</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"green"</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='fu'>density</span>(<span class='no'>res6</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"orange"</span>)</div><div class='input'><span class='fu'>lines</span>(<span class='fu'>density</span>(<span class='no'>res8</span>), <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"pink"</span>)</div><div class='input'><span class='fu'>legend</span>(<span class='fu'>c</span>(-<span class='fl'>0.02</span>, <span class='fl'>0.01</span>), <span class='fu'>c</span>(<span class='fl'>7</span>, <span class='fl'>25</span>),
 <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"0.0"</span>, <span class='st'>"0.2"</span>, <span class='st'>"0.4"</span>, <span class='st'>"0.6"</span>, <span class='st'>"0.8"</span>, <span class='st'>"0.9"</span>),
 <span class='kw'>col</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"black"</span>, <span class='st'>"brown"</span>, <span class='st'>"green"</span>, <span class='st'>"orange"</span>, <span class='st'>"pink"</span>, <span class='st'>"red"</span>), <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>bty</span><span class='kw'>=</span><span class='st'>"n"</span>)</div><div class='img'><img src='invIrM-1.png' alt='' width='700' height='433' /></div><span class='co'># NOT RUN {</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='fu'>length</span>(<span class='no'>nb7rt</span>)), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'>system.time</span>(<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>, <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>)
<span class='fu'>system.time</span>(<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"chol"</span>, <span class='kw'>feasible</span><span class='kw'>=</span><span class='kw'>NULL</span>) <span class='kw'>%*%</span> <span class='no'>x</span>)
<span class='fu'>system.time</span>(<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"solve"</span>, <span class='kw'>feasible</span><span class='kw'>=</span><span class='fl'>TRUE</span>) <span class='kw'>%*%</span> <span class='no'>x</span>)
<span class='fu'>system.time</span>(<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"solve"</span>, <span class='kw'>feasible</span><span class='kw'>=</span><span class='kw'>NULL</span>) <span class='kw'>%*%</span> <span class='no'>x</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>nb7rt</span>), <span class='st'>"CsparseMatrix"</span>)
<span class='fu'>system.time</span>(<span class='no'>ee</span> <span class='kw'>&lt;-</span> <span class='fu'>powerWeights</span>(<span class='no'>W</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.9</span>, <span class='kw'>X</span><span class='kw'>=</span><span class='no'>x</span>))
<span class='fu'>all.equal</span>(<span class='no'>e</span>, <span class='fu'>as</span>(<span class='no'>ee</span>, <span class='st'>"matrix"</span>), <span class='kw'>check.attributes</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>system.time</span>(<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'>invIrM</span>(<span class='no'>nb7rt</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.98</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"solve"</span>, <span class='kw'>feasible</span><span class='kw'>=</span><span class='kw'>NULL</span>) <span class='kw'>%*%</span> <span class='no'>x</span>)
<span class='fu'>system.time</span>(<span class='no'>ee</span> <span class='kw'>&lt;-</span> <span class='fu'>powerWeights</span>(<span class='no'>W</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.98</span>, <span class='kw'>X</span><span class='kw'>=</span><span class='no'>x</span>))
<span class='fu'>str</span>(<span class='fu'>attr</span>(<span class='no'>ee</span>, <span class='st'>"internal"</span>))
<span class='fu'>all.equal</span>(<span class='no'>e</span>, <span class='fu'>as</span>(<span class='no'>ee</span>, <span class='st'>"matrix"</span>), <span class='kw'>check.attributes</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>system.time</span>(<span class='no'>ee</span> <span class='kw'>&lt;-</span> <span class='fu'>powerWeights</span>(<span class='no'>W</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.98</span>, <span class='kw'>order</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>X</span><span class='kw'>=</span><span class='no'>x</span>))
<span class='fu'>all.equal</span>(<span class='no'>e</span>, <span class='fu'>as</span>(<span class='no'>ee</span>, <span class='st'>"matrix"</span>), <span class='kw'>check.attributes</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='no'>nb60rt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cell2nb.html'>cell2nb</a></span>(<span class='fl'>60</span>, <span class='fl'>60</span>, <span class='kw'>torus</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>nb60rt</span>), <span class='st'>"CsparseMatrix"</span>)
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='fu'>dim</span>(<span class='no'>W</span>)[<span class='fl'>1</span>]), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'>system.time</span>(<span class='no'>ee</span> <span class='kw'>&lt;-</span> <span class='fu'>powerWeights</span>(<span class='no'>W</span>, <span class='kw'>rho</span><span class='kw'>=</span><span class='fl'>0.3</span>, <span class='kw'>X</span><span class='kw'>=</span><span class='no'>x</span>))
<span class='fu'>str</span>(<span class='fu'>as</span>(<span class='no'>ee</span>, <span class='st'>"matrix"</span>))
<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='errorsarlm.html'>errorsarlm</a></span>(<span class='fu'>as</span>(<span class='no'>ee</span>, <span class='st'>"matrix"</span>)[,<span class='fl'>1</span>] ~ <span class='fl'>1</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>nb60rt</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"Matrix"</span>)
<span class='fu'>coefficients</span>(<span class='no'>obj</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

