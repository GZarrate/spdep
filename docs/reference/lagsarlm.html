<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial simultaneous autoregressive lag model estimation — lagsarlm • spdep</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Spatial simultaneous autoregressive lag model estimation — lagsarlm" />

<meta property="og:description" content="The lagsarlm function provides Maximum likelihood estimation of spatial simultaneous autoregressive lag and spatial Durbin (mixed) models of the form:
$$y = \rho W y + X \beta + \varepsilon$$
where \(\rho\) is found by optimize() first, and \(\beta\) and other parameters by generalized least squares subsequently (one-dimensional search using optim performs badly on some platforms). In the spatial Durbin (mixed) model, the spatially lagged independent variables are added to X. Note that interpretation of the fitted coefficients should use impact measures, because of the feedback loops induced by the data generation process for this model. With one of the sparse matrix methods, larger numbers of observations can be handled, but the interval= argument may need be set when the weights are not row-standardised.
The spBreg_lag function is an early-release version of the Matlab Spatial Econometrics Toolbox function sar_g.m, using drawing by inversion, and not accommodating heteroskedastic disturbances." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CO69.html">“The Problem of Spatial Autocorrelation:” forty years on</a>
    </li>
    <li>
      <a href="../articles/SpatialFiltering.html">Moran Eigenvectors</a>
    </li>
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
    <li>
      <a href="../articles/sids.html">Introduction to the North Carolina SIDS data set (revised)</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial simultaneous autoregressive lag model estimation</h1>
    
    <div class="hidden name"><code>lagsarlm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The <code>lagsarlm</code> function provides Maximum likelihood estimation of spatial simultaneous autoregressive lag and spatial Durbin (mixed) models of the form:</p>
<p>$$y = \rho W y + X \beta + \varepsilon$$</p>
<p>where \(\rho\) is found by <code><a href='https://www.rdocumentation.org/packages/stats/topics/optimize'>optimize()</a></code> first, and \(\beta\) and other parameters by generalized least squares subsequently (one-dimensional search using optim performs badly on some platforms). In the spatial Durbin (mixed) model, the spatially lagged independent variables are added to X. Note that interpretation of the fitted coefficients should use impact measures, because of the feedback loops induced by the data generation process for this model. With one of the sparse matrix methods, larger numbers of observations can be handled, but the <code>interval=</code> argument may need be set when the weights are not row-standardised.</p>
<p>The <code>spBreg_lag</code> function is an early-release version of the Matlab Spatial Econometrics Toolbox function <code>sar_g.m</code>, using drawing by inversion, and not accommodating heteroskedastic disturbances.</p>
    
    </div>

    <pre class="usage"><span class='fu'>lagsarlm</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='no'>listw</span>,
        <span class='no'>na.action</span>, <span class='no'>Durbin</span>, <span class='no'>type</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"eigen"</span>, <span class='kw'>quiet</span><span class='kw'>=</span><span class='kw'>NULL</span>,
        <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>interval</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>tol.solve</span><span class='kw'>=</span><span class='fl'>1.0e-10</span>, <span class='kw'>trs</span><span class='kw'>=</span><span class='kw'>NULL</span>,
        <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>())
<span class='fu'>spBreg_lag</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='no'>listw</span>, <span class='no'>na.action</span>, <span class='no'>Durbin</span>, <span class='no'>type</span>,
    <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of the model to be fit. The details 
of model specification are given for <code><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm()</a></code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment which the function 
is called.</p></td>
    </tr>
    <tr>
      <th>listw</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function (default <code><a href='https://www.rdocumentation.org/packages/base/topics/options'>options("na.action")</a></code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></td>
    </tr>
    <tr>
      <th>Durbin</th>
      <td><p>default FALSE (spatial lag model); if TRUE, full spatial Durbin model; if a formula object, the subset of explanatory variables to lag</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>(use the &#8216;Durbin=&#8217; argument - retained for backwards compatibility only) default "lag", may be set to "mixed"; when "mixed", the lagged intercept is dropped for spatial weights style "W", that is row-standardised weights, but otherwise included; &#8220;Durbin&#8221; may be used instead of &#8220;mixed&#8221;</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"eigen" (default) - the Jacobian is computed as the product 
of (1 - rho*eigenvalue) using <code>eigenw</code>, and "spam" or "Matrix_J" for strictly symmetric weights lists of styles "B" and "C", or made symmetric by similarity (Ord, 1975, Appendix C) if possible for styles "W" and "S", using code from the spam or Matrix packages to calculate the determinant; &#8220;Matrix&#8221; and &#8220;spam_update&#8221; provide updating Cholesky decomposition methods; "LU" provides an alternative sparse matrix decomposition approach. In addition, there are "Chebyshev" and Monte Carlo "MC" approximate log-determinant methods; the Smirnov/Anselin (2009) trace approximation is available as "moments". Three methods: "SE_classic", "SE_whichMin", and "SE_interp" are provided experimentally, the first to attempt to emulate the behaviour of Spatial Econometrics toolbox ML fitting functions. All use grids of log determinant values, and the latter two attempt to ameliorate some features of "SE_classic".</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>default NULL, use !verbose global option value; if FALSE, reports function values during optimization.</p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE (default) assign NA - causing <code>lagsarlm()</code> to terminate with an error</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>default is NULL, search interval for autoregressive parameter</p></td>
    </tr>
    <tr>
      <th>tol.solve</th>
      <td><p>the tolerance for detecting linear dependencies in the columns of matrices to be inverted - passed to <code><a href='https://www.rdocumentation.org/packages/base/topics/solve'>solve()</a></code> (default=1.0e-10). This may be used if necessary to extract coefficient standard errors (for instance lowering to 1e-12), but errors in <code><a href='https://www.rdocumentation.org/packages/base/topics/solve'>solve()</a></code> may constitute indications of poorly scaled variables: if the variables have scales differing much from the autoregressive coefficient, the values in this matrix may be very different in scale, and inverting such a matrix is analytically possible by definition, but numerically unstable; rescaling the RHS variables alleviates this better than setting tol.solve to a very small value</p></td>
    </tr>
    <tr>
      <th>trs</th>
      <td><p>default NULL, if given, a vector of powered spatial weights matrix traces output by <code>trW</code>; when given, insert the asymptotic analytical values into the numerical Hessian instead of the approximated values; may be used to get around some problems raised when the numerical Hessian is poorly conditioned, generating NaNs in subsequent operations; the use of trs is recommended</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>list of extra control arguments - see section below</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The asymptotic standard error of \(\rho\) is only computed when
method=eigen, because the full matrix operations involved would be costly
for large n typically associated with the choice of method="spam" or "Matrix". The same applies to the coefficient covariance matrix. Taken as the
asymptotic matrix from the literature, it is typically badly scaled, and with the elements involving \(\rho\) being very small,
while other parts of the matrix can be very large (often many orders
of magnitude in difference). It often happens that the <code>tol.solve</code>
argument needs to be set to a smaller value than the default, or the RHS variables can be centred or reduced in range.</p>
<p>Versions of the package from 0.4-38 include numerical Hessian values where asymptotic standard errors are not available. This change has been introduced to permit the simulation of distributions for impact measures. The warnings made above with regard to variable scaling also apply in this case.</p>
<p>Note that the fitted() function for the output object assumes that the response 
variable may be reconstructed as the sum of the trend, the signal, and the
noise (residuals). Since the values of the response variable are known,
their spatial lags are used to calculate signal components (Cressie 1993, p. 564). This differs from other software, including GeoDa, which does not use knowledge of the response 
variable in making predictions for the fitting data.</p>
    
    <h2 class="hasAnchor" id="control-arguments"><a class="anchor" href="#control-arguments"></a>Control arguments</h2>

    <dl class='dl-horizontal'>
  <dt>tol.opt:</dt><dd><p>the desired accuracy of the optimization - passed to <code><a href='https://www.rdocumentation.org/packages/stats/topics/optimize'>optimize()</a></code> (default=square root of double precision machine tolerance, a larger root may be used needed, see help(boston) for an example)</p></dd>
  <dt>fdHess:</dt><dd><p>default NULL, then set to (method != "eigen") internally; use <code>fdHess</code> to compute an approximate Hessian using finite differences when using sparse matrix methods; used to make a coefficient covariance matrix when the number of observations is large; may be turned off to save resources if need be</p></dd>
  <dt>optimHess:</dt><dd><p>default FALSE, use <code>fdHess</code> from <span class="pkg">nlme</span>, if TRUE, use <code>optim</code> to calculate Hessian at optimum</p></dd>
  <dt>optimHessMethod:</dt><dd><p>default &#8220;optimHess&#8221;, may be &#8220;nlm&#8221; or one of the <code>optim</code> methods</p></dd>
  <dt>compiled_sse:</dt><dd><p>default FALSE; logical value used in the log likelihood function to choose compiled code for computing SSE</p></dd>
  <dt>Imult:</dt><dd><p>default 2; used for preparing the Cholesky decompositions for updating in the Jacobian function</p></dd>
  <dt>super:</dt><dd><p>if NULL (default), set to FALSE to use a simplicial decomposition for the sparse Cholesky decomposition and method &#8220;Matrix_J&#8221;, set to  <code><a href='https://www.rdocumentation.org/packages/base/topics/logical'>as.logical(NA)</a></code> for method &#8220;Matrix&#8221;, if TRUE, use a supernodal decomposition</p></dd>
  <dt>cheb_q:</dt><dd><p>default 5; highest power of the approximating polynomial for the Chebyshev approximation</p></dd>
  <dt>MC_p:</dt><dd><p>default 16; number of random variates</p></dd>
  <dt>MC_m:</dt><dd><p>default 30; number of products of random variates matrix and spatial weights matrix</p></dd>
  <dt>spamPivot:</dt><dd><p>default &#8220;MMD&#8221;, alternative &#8220;RCM&#8221;</p></dd>
  <dt>in_coef</dt><dd><p>default 0.1, coefficient value for initial Cholesky decomposition in &#8220;spam_update&#8221;</p></dd>
  <dt>type</dt><dd><p>default &#8220;MC&#8221;, used with method &#8220;moments&#8221;; alternatives &#8220;mult&#8221; and &#8220;moments&#8221;, for use if <code>trs</code> is missing, <code><a href='trW.html'>trW</a></code></p></dd>
  <dt>correct</dt><dd><p>default TRUE, used with method &#8220;moments&#8221; to compute the Smirnov/Anselin correction term</p></dd>
  <dt>trunc</dt><dd><p>default TRUE, used with method &#8220;moments&#8221; to truncate the Smirnov/Anselin correction term</p></dd>
  <dt>SE_method</dt><dd><p>default &#8220;LU&#8221;, may be &#8220;MC&#8221;</p></dd>
  <dt>nrho</dt><dd><p>default 200, as in SE toolbox; the size of the first stage lndet grid; it may be reduced to for example 40</p></dd>
  <dt>interpn</dt><dd><p>default 2000, as in SE toolbox; the size of the second stage lndet grid</p></dd>
  <dt>small_asy</dt><dd><p>default TRUE; if the method is not &#8220;eigen&#8221;, use asymmetric covariances rather than numerical Hessian ones if n &lt;= small</p></dd>
  <dt>small</dt><dd><p>default 1500; threshold number of observations for asymmetric covariances when the method is not &#8220;eigen&#8221;</p></dd>
  <dt>SElndet</dt><dd><p>default NULL, may be used to pass a pre-computed SE toolbox style matrix of coefficients and their lndet values to the "SE_classic" and "SE_whichMin" methods</p></dd>
  <dt>LU_order</dt><dd><p>default FALSE; used in &#8220;LU_prepermutate&#8221;, note warnings given for <code>lu</code> method</p></dd>
  <dt>pre_eig</dt><dd><p>default NULL; may be used to pass a pre-computed vector of eigenvalues</p></dd>
  <dt>OrdVsign</dt><dd><p>default 1; used to set the sign of the final component to negative if -1 (alpha times ((sigma squared) squared) in Ord (1975) equation B.1).</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="extra-bayesian-control-arguments"><a class="anchor" href="#extra-bayesian-control-arguments"></a>Extra Bayesian control arguments</h2>

    <dl class='dl-horizontal'>
  <dt>ldet_method</dt><dd><p>default &#8220;SE_classic&#8221;; equivalent to the <code>method</code> argument in <code>lagsarlm</code></p></dd>
  <dt>interval</dt><dd><p>default <code><a href='https://www.rdocumentation.org/packages/base/topics/c'>c(-1, 1)</a></code>; used unmodified or set internally by <code>jacobianSetup</code></p></dd>
  <dt>ndraw</dt><dd><p>default <code>2500L</code>; integer total number of draws</p></dd>
  <dt>nomit</dt><dd><p>default <code>500L</code>; integer total number of omitted burn-in draws</p></dd>
  <dt>thin</dt><dd><p>default <code>1L</code>; integer thinning proportion</p></dd>
  <dt>verbose</dt><dd><p>default <code>FALSE</code>; inverse of <code>quiet</code> argument in <code>lagsarlm</code></p></dd>
  <dt>detval</dt><dd><p>default <code>NULL</code>; not yet in use, precomputed matrix of log determinants</p></dd>
  <dt>prior</dt><dd><p>a list with the following components:
    <dl class='dl-horizontal'>
      <dt>rhoMH</dt><dd><p>default FALSE; use Metropolis or griddy Gibbs</p></dd>
      <dt>Tbeta</dt><dd><p>default <code>NULL</code>; values of the betas variance-covariance matrix, set to <code>diag(k)*1e+12</code> if <code>NULL</code></p></dd>
      <dt>c_beta</dt><dd><p>default <code>NULL</code>; values of the betas set to 0 if <code>NULL</code></p></dd>
      <dt>rho</dt><dd><p>default <code>0.5</code>; value of the autoregressive coefficient</p></dd>
      <dt>sige</dt><dd><p>default <code>1</code>; value of the residual variance</p></dd>
      <dt>nu</dt><dd><p>default <code>0</code>; informative Gamma(nu,d0) prior on sige</p></dd>
      <dt>d0</dt><dd><p>default <code>0</code>; informative Gamma(nu,d0) prior on sige</p></dd>
      <dt>a1</dt><dd><p>default <code>1.01</code>; parameter for beta(a1,a2) prior on rho</p></dd>
      <dt>a2</dt><dd><p>default <code>1.01</code>; parameter for beta(a1,a2) prior on rho</p></dd>
    </dl></p></dd>
</dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list object of class <code>sarlm</code></p>
<dt>type</dt><dd><p>"lag" or "mixed"</p></dd>
  <dt>dvars</dt><dd><p>vector of length 2, numbers of columns in X and WX; if Durbin is given as a formula, the formula as attribute &#8220;f&#8221;, the indices of the included Wx as &#8220;inds&#8221;, and indices of added zero Wx coefficients as &#8220;zero_fill&#8221;</p></dd>
  <dt>rho</dt><dd><p>simultaneous autoregressive lag coefficient</p></dd>
  <dt>coefficients</dt><dd><p>GLS coefficient estimates</p></dd>
  <dt>rest.se</dt><dd><p>asymptotic standard errors if ase=TRUE, otherwise approximate numeriacal Hessian-based values</p></dd>
  <dt>LL</dt><dd><p>log likelihood value at computed optimum</p></dd>
  <dt>s2</dt><dd><p>GLS residual variance</p></dd>
  <dt>SSE</dt><dd><p>sum of squared GLS errors</p></dd>
  <dt>parameters</dt><dd><p>number of parameters estimated</p></dd>
%  \item{lm.model}{the \code{lm} object returned when estimating for \eqn{\rho=0}{rho=0}}
  <dt>logLik_lm.model</dt><dd><p>Log likelihood of the linear model for \(\rho=0\)</p></dd>
  <dt>AIC_lm.model</dt><dd><p>AIC of the linear model for \(\rho=0\)</p></dd>
  <dt>method</dt><dd><p>the method used to calculate the Jacobian</p></dd>
  <dt>call</dt><dd><p>the call used to create this object</p></dd>
  <dt>residuals</dt><dd><p>GLS residuals</p></dd>
  <dt>tarX</dt><dd><p>model matrix of the GLS model</p></dd>
  <dt>tary</dt><dd><p>response of the GLS model</p></dd>
  <dt>y</dt><dd><p>response of the linear model for \(\rho=0\)</p></dd>
  <dt>X</dt><dd><p>model matrix of the linear model for \(\rho=0\)</p></dd>
%  \item{lm.target}{the \code{lm} object returned for the GLS fit}
  <dt>opt</dt><dd><p>object returned from numerical optimisation</p></dd>
  <dt>fitted.values</dt><dd><p>Difference between residuals and response variable</p></dd>
  <dt>se.fit</dt><dd><p>Not used yet</p></dd>
%  \item{formula}{model formula}
  <dt>ase</dt><dd><p>TRUE if method=eigen</p></dd>
  <dt>rho.se</dt><dd><p>if ase=TRUE, the asymptotic standard error of \(\rho\), otherwise approximate numeriacal Hessian-based value</p></dd>
  <dt>LMtest</dt><dd><p>if ase=TRUE, the Lagrange Multiplier test for the absence
of spatial autocorrelation in the lag model residuals</p></dd>
  <dt>resvar</dt><dd><p>the asymptotic coefficient covariance matrix for (s2, rho, B)</p></dd>
  <dt>zero.policy</dt><dd><p>zero.policy for this model</p></dd>
  <dt>aliased</dt><dd><p>the aliased explanatory variables (if any)</p></dd>
  <dt>listw_style</dt><dd><p>the style of the spatial weights used</p></dd>
  <dt>interval</dt><dd><p>the line search interval used to find \(\rho\)</p></dd>
  <dt>fdHess</dt><dd><p>the numerical Hessian-based coefficient covariance matrix for (rho, B) if computed</p></dd>
  <dt>optimHess</dt><dd><p>if TRUE and fdHess returned, <code>optim</code> used to calculate Hessian at optimum</p></dd>
  <dt>insert</dt><dd><p>if TRUE and fdHess returned, the asymptotic analytical values are inserted into the numerical Hessian instead of the approximated values, and its size increased to include the first row/column for sigma2</p></dd>
  <dt>LLNullLlm</dt><dd><p>Log-likelihood of the null linear model</p></dd>
  <dt>timings</dt><dd><p>processing timings</p></dd>
  <dt>f_calls</dt><dd><p>number of calls to the log likelihood function during optimization</p></dd>
  <dt>hf_calls</dt><dd><p>number of calls to the log likelihood function during numerical Hessian computation</p></dd>
  <dt>intern_classic</dt><dd><p>a data frame of detval matrix row choices used by the SE toolbox classic method</p></dd>
  <dt>na.action</dt><dd><p>(possibly) named vector of excluded or omitted observations if non-default na.action argument used</p></dd>

The internal sar.lag.mixed.* functions return the value of the log likelihood function at \rhorho.


    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cliff, A. D., Ord, J. K. 1981 <em>Spatial processes</em>, Pion;
Ord, J. K. 1975 Estimation methods for models of spatial interaction,
<em>Journal of the American Statistical Association</em>, 70, 120-126;
Anselin, L. 1988 <em>Spatial econometrics: methods and models.</em>
(Dordrecht: Kluwer); Anselin, L. 1995 SpaceStat, a software program for
the analysis of spatial data, version 1.80. Regional Research Institute,
West Virginia University, Morgantown, WV;
Anselin L, Bera AK (1998) Spatial dependence in linear regression models
with an introduction to spatial econometrics. In: Ullah A, Giles DEA
(eds) Handbook of applied economic statistics. Marcel Dekker, New York,
pp. 237-289; Cressie, N. A. C. 1993 <em>Statistics for spatial data</em>, Wiley, New York; LeSage J and RK Pace (2009) Introduction to Spatial Econometrics. CRC Press, Boca Raton.</p>
<p>Roger Bivand, Gianfranco Piras (2015). Comparing Implementations of Estimation Methods for Spatial Econometrics. <em>Journal of Statistical Software</em>, 63(18), 1-36. <a href='https://www.jstatsoft.org/v63/i18/'>https://www.jstatsoft.org/v63/i18/</a>.</p>
<p>Bivand, R. S., Hauke, J., and Kossowski, T. (2013). Computing the Jacobian in Gaussian spatial autoregressive models: An illustrated comparison of available methods. <em>Geographical Analysis</em>, 45(2), 150-179.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/stats/topics/lm'>lm</a></code>, <code><a href='errorsarlm.html'>errorsarlm</a></code>, 
<code><a href='summary.sarlm.html'>summary.sarlm</a></code>, <code><a href='eigenw.html'>eigenw</a></code>,  
<code><a href='predict.sarlm.html'>predict.sarlm</a></code>, <code><a href='impacts.sarlm.html'>impacts.sarlm</a></code>,
<code><a href='residuals.sarlm.html'>residuals.sarlm</a></code>, <code><a href='do_ldet.html'>do_ldet</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>oldcol</span>)
<span class='no'>listw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>, <span class='kw'>style</span><span class='kw'>=</span><span class='st'>"W"</span>)
<span class='no'>ev</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eigenw.html'>eigenw</a></span>(<span class='no'>listw</span>)
<span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>listw</span>, <span class='st'>"CsparseMatrix"</span>)
<span class='no'>trMatc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='trW.html'>trW</a></span>(<span class='no'>W</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mult"</span>)
<span class='no'>COL.lag.eig</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>,
 <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"eigen"</span>, <span class='kw'>quiet</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>, <span class='kw'>OrdVsign</span><span class='kw'>=</span><span class='fl'>1</span>))</div><div class='output co'>#&gt; 
#&gt; Spatial lag model
#&gt; Jacobian calculated using neighbourhood matrix eigenvalues
#&gt; 
#&gt; rho:	 -0.5674437 	function value:	 -202.2909 
#&gt; rho:	 0.03126655 	function value:	 -186.749 
#&gt; rho:	 0.4012898 	function value:	 -182.419 
#&gt; rho:	 0.6138418 	function value:	 -183.5636 
#&gt; rho:	 0.4157662 	function value:	 -182.398 
#&gt; rho:	 0.4295565 	function value:	 -182.3905 
#&gt; rho:	 0.4311288 	function value:	 -182.3904 
#&gt; rho:	 0.4310273 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.eig</span>, <span class='kw'>correlation</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     method = "eigen", quiet = FALSE, control = list(pre_eig = ev, 
#&gt;         OrdVsign = 1))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 45.079251   7.177347  6.2808 3.369e-10
#&gt; INC         -1.031616   0.305143 -3.3808 0.0007229
#&gt; HOVAL       -0.265926   0.088499 -3.0049 0.0026570
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Asymptotic standard error: 0.11768
#&gt;     z-value: 3.6626, p-value: 0.00024962
#&gt; Wald statistic: 13.415, p-value: 0.00024962
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.31955, p-value: 0.57188
#&gt; 
#&gt;  Correlation of coefficients 
#&gt;             sigma rho   (Intercept) INC  
#&gt; rho         -0.14                        
#&gt; (Intercept)  0.12 -0.83                  
#&gt; INC         -0.05  0.35 -0.61            
#&gt; HOVAL       -0.01  0.08 -0.25       -0.44
#&gt; </div><div class='input'><span class='no'>COL.lag.eig</span>$<span class='no'>fdHess</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='no'>COL.lag.eig</span>$<span class='no'>resvar</span></div><div class='output co'>#&gt;                    sigma           rho (Intercept)         INC         HOVAL
#&gt; sigma       379.77510361 -0.3236306318  16.3015079 -0.29590801 -0.0202478459
#&gt; rho          -0.32363063  0.0138487533  -0.6975717  0.01266245  0.0008664428
#&gt; (Intercept)  16.30150788 -0.6975716738  51.5143034 -1.32602704 -0.1616379856
#&gt; INC          -0.29590801  0.0126624511  -1.3260270  0.09311223 -0.0117959715
#&gt; HOVAL        -0.02024785  0.0008664428  -0.1616380 -0.01179597  0.0078320057</div><div class='input'><span class='co'># using the apparent sign in Ord (1975, equation B.1) </span>
<span class='no'>COL.lag.eigb</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>,
 <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"eigen"</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>, <span class='kw'>OrdVsign</span><span class='kw'>=</span>-<span class='fl'>1</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.eigb</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     method = "eigen", control = list(pre_eig = ev, OrdVsign = -1))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 45.079251   9.617835  4.6870 2.772e-06
#&gt; INC         -1.031616   0.326524 -3.1594  0.001581
#&gt; HOVAL       -0.265926   0.088855 -2.9928  0.002764
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Asymptotic standard error: 0.17322
#&gt;     z-value: 2.4884, p-value: 0.012833
#&gt; Wald statistic: 6.1919, p-value: 0.012833
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; LM test for residual autocorrelation
#&gt; test value: -0.93825, p-value: 1
#&gt; </div><div class='input'><span class='no'>COL.lag.eigb</span>$<span class='no'>fdHess</span></div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='no'>COL.lag.eigb</span>$<span class='no'>resvar</span></div><div class='output co'>#&gt;                    sigma          rho (Intercept)         INC        HOVAL
#&gt; sigma       388.59742931 -0.701154266  35.3176451 -0.64109248 -0.043867490
#&gt; rho          -0.70115427  0.030003688  -1.5113074  0.02743353  0.001877171
#&gt; (Intercept)  35.31764510 -1.511307358  92.5027556 -2.07005707 -0.212549096
#&gt; INC          -0.64109248  0.027433533  -2.0700571  0.10661800 -0.010871824
#&gt; HOVAL        -0.04386749  0.001877171  -0.2125491 -0.01087182  0.007895242</div><div class='input'><span class='co'># force numerical Hessian</span>
<span class='no'>COL.lag.eig1</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"Matrix"</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>small</span><span class='kw'>=</span><span class='fl'>25</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.eig1</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     method = "Matrix", control = list(small = 25))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (numerical Hessian approximate standard errors) 
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)
#&gt; (Intercept) 45.07925    7.87089  5.7273 1.02e-08
#&gt; INC         -1.03162    0.32842 -3.1411 0.001683
#&gt; HOVAL       -0.26593    0.08823 -3.0140 0.002578
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Approximate (numerical Hessian) standard error: 0.12362
#&gt;     z-value: 3.4868, p-value: 0.00048892
#&gt; Wald statistic: 12.157, p-value: 0.00048892
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; </div><div class='input'><span class='no'>COL.lag.eig1</span>$<span class='no'>fdHess</span></div><div class='output co'>#&gt;                       rho (Intercept)         INC         HOVAL
#&gt; rho          0.0152812237  -0.8345267  0.02005558  0.0002830225
#&gt; (Intercept) -0.8345266779  61.9509427 -1.78340176 -0.1334585288
#&gt; INC          0.0200555771  -1.7834018  0.10786140 -0.0122204417
#&gt; HOVAL        0.0002830225  -0.1334585 -0.01222044  0.0077846055</div><div class='input'><span class='co'># force LeSage &amp; Pace (2008, p. 57) approximation </span>
<span class='no'>COL.lag.eig1a</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"Matrix"</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>small</span><span class='kw'>=</span><span class='fl'>25</span>), <span class='kw'>trs</span><span class='kw'>=</span><span class='no'>trMatc</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.eig1a</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     method = "Matrix", trs = trMatc, control = list(small = 25))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (numerical Hessian approximate standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 45.079249   7.937572  5.6792 1.353e-08
#&gt; INC         -1.031616   0.329337 -3.1324  0.001734
#&gt; HOVAL       -0.265926   0.088222 -3.0143  0.002576
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Approximate (numerical Hessian) standard error: 0.12503
#&gt;     z-value: 3.4473, p-value: 0.00056624
#&gt; Wald statistic: 11.884, p-value: 0.00056624
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; </div><div class='input'><span class='no'>COL.lag.eig1a</span>$<span class='no'>fdHess</span></div><div class='output co'>#&gt;                    sigma2           rho (Intercept)         INC         HOVAL
#&gt; sigma2      380.749548407 -0.3653290756  19.9519208 -0.47947507 -0.0067851124
#&gt; rho          -0.365329076  0.0156331058  -0.8537795  0.02051762  0.0002903475
#&gt; (Intercept)  19.951920812 -0.8537795385  63.0050547 -1.80875071 -0.1338515483
#&gt; INC          -0.479475072  0.0205176238  -1.8087507  0.10846276 -0.0122071279
#&gt; HOVAL        -0.006785112  0.0002903475  -0.1338515 -0.01220713  0.0077831895</div><div class='input'><span class='no'>COL.lag.eig</span>$<span class='no'>resvar</span>[<span class='fl'>2</span>,<span class='fl'>2</span>]</div><div class='output co'>#&gt; [1] 0.01384875</div><div class='input'><span class='co'># using the apparent sign in Ord (1975, equation B.1) </span>
<span class='no'>COL.lag.eigb</span>$<span class='no'>resvar</span>[<span class='fl'>2</span>,<span class='fl'>2</span>]</div><div class='output co'>#&gt; [1] 0.03000369</div><div class='input'><span class='co'># force numerical Hessian</span>
<span class='no'>COL.lag.eig1</span>$<span class='no'>fdHess</span>[<span class='fl'>1</span>,<span class='fl'>1</span>]</div><div class='output co'>#&gt; [1] 0.01528122</div><div class='input'><span class='co'># force LeSage &amp; Pace (2008, p. 57) approximation </span>
<span class='no'>COL.lag.eig1a</span>$<span class='no'>fdHess</span>[<span class='fl'>2</span>,<span class='fl'>2</span>]</div><div class='output co'>#&gt; [1] 0.01563311</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.time'>system.time</a></span>(<span class='no'>COL.lag.M</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"Matrix"</span>, <span class='kw'>quiet</span><span class='kw'>=</span><span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; 
#&gt; Spatial lag model
#&gt; Jacobian calculated using sparse matrix Cholesky decomposition
#&gt; rho:	 -0.2364499 	function value:	 -192.9523 
#&gt; rho:	 0.2354499 	function value:	 -183.542 
#&gt; rho:	 0.5271001 	function value:	 -182.7039 
#&gt; rho:	 0.4455543 	function value:	 -182.3974 
#&gt; rho:	 0.4267907 	function value:	 -182.391 
#&gt; rho:	 0.4311986 	function value:	 -182.3904 
#&gt; rho:	 0.4310114 	function value:	 -182.3904 
#&gt; rho:	 0.4310231 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; Computing eigenvalues ...
#&gt; </div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.197   0.000   0.199 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.M</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = nb2listw(COL.nb), 
#&gt;     method = "Matrix", quiet = FALSE)
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 45.079249   7.177346  6.2808 3.369e-10
#&gt; INC         -1.031616   0.305143 -3.3808 0.0007229
#&gt; HOVAL       -0.265926   0.088499 -3.0049 0.0026570
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Asymptotic standard error: 0.11768
#&gt;     z-value: 3.6626, p-value: 0.00024962
#&gt; Wald statistic: 13.415, p-value: 0.00024962
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.31954, p-value: 0.57188
#&gt; </div><div class='input'><span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.lag.M</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>))</div><div class='output co'>#&gt; Impact measures (lag, exact):
#&gt;           Direct   Indirect      Total
#&gt; INC   -1.0860220 -0.7270848 -1.8131068
#&gt; HOVAL -0.2799509 -0.1874254 -0.4673763</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.time'>system.time</a></span>(<span class='no'>COL.lag.sp</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"spam"</span>, <span class='kw'>quiet</span><span class='kw'>=</span><span class='fl'>FALSE</span>))</div><div class='output co'>#&gt; 
#&gt; Spatial lag model
#&gt; Jacobian calculated using sparse matrix Cholesky decomposition
#&gt; rho:	 -0.2364499 	function value:	 -192.9523 
#&gt; rho:	 0.2354499 	function value:	 -183.542 
#&gt; rho:	 0.5271001 	function value:	 -182.7039 
#&gt; rho:	 0.4455543 	function value:	 -182.3974 
#&gt; rho:	 0.4267907 	function value:	 -182.391 
#&gt; rho:	 0.4311986 	function value:	 -182.3904 
#&gt; rho:	 0.4310114 	function value:	 -182.3904 
#&gt; rho:	 0.4310231 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; rho:	 0.4310232 	function value:	 -182.3904 
#&gt; Computing eigenvalues ...
#&gt; </div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.214   0.000   0.219 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.sp</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = nb2listw(COL.nb), 
#&gt;     method = "spam", quiet = FALSE)
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 45.079250   7.177347  6.2808 3.369e-10
#&gt; INC         -1.031616   0.305143 -3.3808 0.0007229
#&gt; HOVAL       -0.265926   0.088499 -3.0049 0.0026570
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Asymptotic standard error: 0.11768
#&gt;     z-value: 3.6626, p-value: 0.00024962
#&gt; Wald statistic: 13.415, p-value: 0.00024962
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.31954, p-value: 0.57188
#&gt; </div><div class='input'><span class='no'>COL.lag.B</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>, <span class='kw'>style</span><span class='kw'>=</span><span class='st'>"B"</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.B</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = nb2listw(COL.nb, 
#&gt;     style = "B"))
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -33.6975  -4.7996  -1.4808   5.3648  25.8922 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 52.403878   5.961310  8.7907 &lt; 2.2e-16
#&gt; INC         -1.175261   0.300473 -3.9114 9.178e-05
#&gt; HOVAL       -0.252680   0.087613 -2.8840  0.003926
#&gt; 
#&gt; Rho: 0.051981, LR test value: 12.764, p-value: 0.00035336
#&gt; Asymptotic standard error: 0.014428
#&gt;     z-value: 3.6028, p-value: 0.00031482
#&gt; Wald statistic: 12.98, p-value: 0.00031482
#&gt; 
#&gt; Log likelihood: -180.9953 for lag model
#&gt; ML residual variance (sigma squared): 93.29, (sigma: 9.6587)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 371.99, (AIC for lm: 382.75)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.0028047, p-value: 0.95776
#&gt; </div><div class='input'><span class='no'>COL.mixed.B</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>, <span class='kw'>style</span><span class='kw'>=</span><span class='st'>"B"</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mixed"</span>, <span class='kw'>tol.solve</span><span class='kw'>=</span><span class='fl'>1e-9</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.B</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = nb2listw(COL.nb, 
#&gt;     style = "B"), type = "mixed", tol.solve = 1e-09, control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -34.8460  -4.2057  -0.1195   4.6525  21.6112 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;                    Estimate  Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept)      5.4215e+01  5.6639e+00  9.5719 &lt; 2.2e-16
#&gt; INC             -8.2386e-01  3.1643e-01 -2.6036 0.0092262
#&gt; HOVAL           -3.0085e-01  8.5629e-02 -3.5134 0.0004424
#&gt; lag.(Intercept) -7.5493e+00  1.7307e+00 -4.3620 1.289e-05
#&gt; lag.INC          2.1544e-05  1.2216e-01  0.0002 0.9998593
#&gt; lag.HOVAL        7.2458e-02  3.9007e-02  1.8576 0.0632281
#&gt; 
#&gt; Rho: 0.15212, LR test value: 7.435, p-value: 0.0063967
#&gt; Asymptotic standard error: 0.015565
#&gt;     z-value: 9.7735, p-value: &lt; 2.22e-16
#&gt; Wald statistic: 95.522, p-value: &lt; 2.22e-16
#&gt; 
#&gt; Log likelihood: -177.7722 for mixed model
#&gt; ML residual variance (sigma squared): 82.502, (sigma: 9.0831)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 8 
#&gt; AIC: 371.54, (AIC for lm: 376.98)
#&gt; LM test for residual autocorrelation
#&gt; test value: -26.79, p-value: 1
#&gt; </div><div class='input'><span class='no'>COL.mixed.W</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mixed"</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.W</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     type = "mixed", control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.47829  -6.46731  -0.33835   6.05200  22.62969 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 42.822414  12.667204  3.3806 0.0007233
#&gt; INC         -0.914223   0.331094 -2.7612 0.0057586
#&gt; HOVAL       -0.293738   0.089212 -3.2926 0.0009927
#&gt; lag.INC     -0.520284   0.565129 -0.9206 0.3572355
#&gt; lag.HOVAL    0.245640   0.178917  1.3729 0.1697756
#&gt; 
#&gt; Rho: 0.42634, LR test value: 5.3693, p-value: 0.020494
#&gt; Asymptotic standard error: 0.15623
#&gt;     z-value: 2.7288, p-value: 0.0063561
#&gt; Wald statistic: 7.4465, p-value: 0.0063561
#&gt; 
#&gt; Log likelihood: -181.3935 for mixed model
#&gt; ML residual variance (sigma squared): 91.791, (sigma: 9.5808)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 7 
#&gt; AIC: 376.79, (AIC for lm: 380.16)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.28919, p-value: 0.59074
#&gt; </div><div class='input'><span class='no'>COL.mixed.D00</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.D00</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     Durbin = TRUE, control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.47829  -6.46731  -0.33835   6.05200  22.62969 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 42.822414  12.667204  3.3806 0.0007233
#&gt; INC         -0.914223   0.331094 -2.7612 0.0057586
#&gt; HOVAL       -0.293738   0.089212 -3.2926 0.0009927
#&gt; lag.INC     -0.520284   0.565129 -0.9206 0.3572355
#&gt; lag.HOVAL    0.245640   0.178917  1.3729 0.1697756
#&gt; 
#&gt; Rho: 0.42634, LR test value: 5.3693, p-value: 0.020494
#&gt; Asymptotic standard error: 0.15623
#&gt;     z-value: 2.7288, p-value: 0.0063561
#&gt; Wald statistic: 7.4465, p-value: 0.0063561
#&gt; 
#&gt; Log likelihood: -181.3935 for mixed model
#&gt; ML residual variance (sigma squared): 91.791, (sigma: 9.5808)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 7 
#&gt; AIC: 376.79, (AIC for lm: 380.16)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.28919, p-value: 0.59074
#&gt; </div><div class='input'><span class='no'>COL.mixed.D01</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.D01</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     Durbin = FALSE, control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.68585  -5.35636   0.05421   6.02013  23.20555 
#&gt; 
#&gt; Type: lag 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 45.079251   7.177347  6.2808 3.369e-10
#&gt; INC         -1.031616   0.305143 -3.3808 0.0007229
#&gt; HOVAL       -0.265926   0.088499 -3.0049 0.0026570
#&gt; 
#&gt; Rho: 0.43102, LR test value: 9.9736, p-value: 0.001588
#&gt; Asymptotic standard error: 0.11768
#&gt;     z-value: 3.6626, p-value: 0.00024962
#&gt; Wald statistic: 13.415, p-value: 0.00024962
#&gt; 
#&gt; Log likelihood: -182.3904 for lag model
#&gt; ML residual variance (sigma squared): 95.494, (sigma: 9.7721)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 5 
#&gt; AIC: 374.78, (AIC for lm: 382.75)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.31955, p-value: 0.57188
#&gt; </div><div class='input'><span class='no'>COL.mixed.D1</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.D1</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     Durbin = ~INC + HOVAL, control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.47829  -6.46731  -0.33835   6.05200  22.62969 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 42.822414  12.667204  3.3806 0.0007233
#&gt; INC         -0.914223   0.331094 -2.7612 0.0057586
#&gt; HOVAL       -0.293738   0.089212 -3.2926 0.0009927
#&gt; lag.INC     -0.520284   0.565129 -0.9206 0.3572355
#&gt; lag.HOVAL    0.245640   0.178917  1.3729 0.1697756
#&gt; 
#&gt; Rho: 0.42634, LR test value: 5.3693, p-value: 0.020494
#&gt; Asymptotic standard error: 0.15623
#&gt;     z-value: 2.7288, p-value: 0.0063561
#&gt; Wald statistic: 7.4465, p-value: 0.0063561
#&gt; 
#&gt; Log likelihood: -181.3935 for mixed model
#&gt; ML residual variance (sigma squared): 91.791, (sigma: 9.5808)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 7 
#&gt; AIC: 376.79, (AIC for lm: 380.16)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.28919, p-value: 0.59074
#&gt; </div><div class='input'><span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>
<span class='no'>COL.mixed.D2</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>f</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='no'>listw</span>,
 <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/formula'>as.formula</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/delete.response'>delete.response</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/terms'>terms</a></span>(<span class='no'>f</span>))),
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.D2</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = f, data = COL.OLD, listw = listw, Durbin = as.formula(delete.response(terms(f))), 
#&gt;     control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.47829  -6.46731  -0.33835   6.05200  22.62969 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 42.822414  12.667204  3.3806 0.0007233
#&gt; INC         -0.914223   0.331094 -2.7612 0.0057586
#&gt; HOVAL       -0.293738   0.089212 -3.2926 0.0009927
#&gt; lag.INC     -0.520284   0.565129 -0.9206 0.3572355
#&gt; lag.HOVAL    0.245640   0.178917  1.3729 0.1697756
#&gt; 
#&gt; Rho: 0.42634, LR test value: 5.3693, p-value: 0.020494
#&gt; Asymptotic standard error: 0.15623
#&gt;     z-value: 2.7288, p-value: 0.0063561
#&gt; Wald statistic: 7.4465, p-value: 0.0063561
#&gt; 
#&gt; Log likelihood: -181.3935 for mixed model
#&gt; ML residual variance (sigma squared): 91.791, (sigma: 9.5808)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 7 
#&gt; AIC: 376.79, (AIC for lm: 380.16)
#&gt; LM test for residual autocorrelation
#&gt; test value: 0.28919, p-value: 0.59074
#&gt; </div><div class='input'><span class='no'>COL.mixed.D1a</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span> ~ <span class='no'>INC</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.mixed.D1a</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     Durbin = ~INC, control = list(pre_eig = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.82800  -5.85207   0.12047   6.00137  23.19963 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 48.814687  12.198232  4.0018 6.287e-05
#&gt; INC         -1.006620   0.330641 -3.0445  0.002331
#&gt; HOVAL       -0.265514   0.088768 -2.9911  0.002780
#&gt; lag.INC     -0.186684   0.530550 -0.3519  0.724936
#&gt; 
#&gt; Rho: 0.39229, LR test value: 4.5007, p-value: 0.033881
#&gt; Asymptotic standard error: 0.1561
#&gt;     z-value: 2.513, p-value: 0.011971
#&gt; Wald statistic: 6.3151, p-value: 0.011971
#&gt; 
#&gt; Log likelihood: -182.3328 for mixed model
#&gt; ML residual variance (sigma squared): 96.122, (sigma: 9.8042)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 6 
#&gt; AIC: 376.67, (AIC for lm: 379.17)
#&gt; LM test for residual autocorrelation
#&gt; test value: 2.6134, p-value: 0.10596
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/try'>try</a></span>(<span class='no'>COL.mixed.D1</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span> ~ <span class='no'>inc</span> + <span class='no'>HOVAL</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>)))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/try'>try</a></span>(<span class='no'>COL.mixed.D1</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span> ~ <span class='no'>DISCBD</span> + <span class='no'>HOVAL</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>pre_eig</span><span class='kw'>=</span><span class='no'>ev</span>)))
<span class='no'>NA.COL.OLD</span> <span class='kw'>&lt;-</span> <span class='no'>COL.OLD</span>
<span class='no'>NA.COL.OLD</span>$<span class='no'>CRIME</span>[<span class='fl'>20</span>:<span class='fl'>25</span>] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>COL.lag.NA</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>NA.COL.OLD</span>,
 <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>), <span class='kw'>na.action</span><span class='kw'>=</span><span class='no'>na.exclude</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>tol.opt</span><span class='kw'>=</span><span class='no'>.Machine</span>$<span class='no'>double.eps</span>^<span class='fl'>0.4</span>))
<span class='no'>COL.lag.NA</span>$<span class='no'>na.action</span></div><div class='output co'>#&gt; 1020 1021 1022 1023 1024 1025 
#&gt;   20   21   22   23   24   25 
#&gt; attr(,"class")
#&gt; [1] "exclude"</div><div class='input'><span class='no'>COL.lag.NA</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = CRIME ~ INC + HOVAL, data = NA.COL.OLD, listw = nb2listw(COL.nb), 
#&gt;     na.action = na.exclude, control = list(tol.opt = .Machine$double.eps^0.4))
#&gt; Type: lag 
#&gt; 
#&gt; Coefficients:
#&gt;         rho (Intercept)         INC       HOVAL 
#&gt;   0.4537820  43.1054975  -0.9267352  -0.2715541 
#&gt; 
#&gt; Log likelihood: -160.8867 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/residuals'>resid</a></span>(<span class='no'>COL.lag.NA</span>)</div><div class='output co'>#&gt;        1001        1002        1003        1004        1005        1006 
#&gt;  -4.4352945 -13.2750948  -2.9233555 -37.3067542   1.3568011  -3.8828027 
#&gt;        1007        1008        1009        1010        1011        1012 
#&gt;   5.9980436 -12.8113318  -4.0482558  18.1813323   5.9714203   1.0035599 
#&gt;        1013        1014        1015        1016        1017        1018 
#&gt;  -1.7490666  -1.7490651   5.8456328  10.1074158  -4.3706895   3.3713771 
#&gt;        1019        1020        1021        1022        1023        1024 
#&gt;  -4.0823022          NA          NA          NA          NA          NA 
#&gt;        1025        1026        1027        1028        1029        1030 
#&gt;          NA  -6.0553296 -11.5813311  -8.0011389  -1.9047478   3.9744243 
#&gt;        1031        1032        1033        1034        1035        1036 
#&gt;   4.8148614   6.0673483  10.2059847  22.7419913  -2.0830998   0.1422777 
#&gt;        1037        1038        1039        1040        1041        1042 
#&gt;   8.6436388   8.8150864   6.4974685  15.4121789   9.4182148   5.6427603 
#&gt;        1043        1044        1045        1046        1047        1048 
#&gt;  -7.5727123  -7.5983733  -9.7792620 -10.0870764  -3.1242393   3.4921796 
#&gt;        1049 
#&gt;   0.7173251 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>boston</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)
<span class='no'>gp2mM</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>CMEDV</span>) ~ <span class='no'>CRIM</span> + <span class='no'>ZN</span> + <span class='no'>INDUS</span> + <span class='no'>CHAS</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='no'>NOX</span>^<span class='fl'>2</span>) +
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='no'>RM</span>^<span class='fl'>2</span>) +  <span class='no'>AGE</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>DIS</span>) + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>RAD</span>) + <span class='no'>TAX</span> + <span class='no'>PTRATIO</span> + <span class='no'>B</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>LSTAT</span>),
<span class='kw'>data</span><span class='kw'>=</span><span class='no'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>boston.soi</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mixed"</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"Matrix"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>gp2mM</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + 
#&gt;     I(RM^2) + AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + 
#&gt;     log(LSTAT), data = boston.c, listw = nb2listw(boston.soi), 
#&gt;     type = "mixed", method = "Matrix")
#&gt; 
#&gt; Residuals:
#&gt;        Min         1Q     Median         3Q        Max 
#&gt; -0.6316833 -0.0629790 -0.0090776  0.0682421  0.6991072 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;                   Estimate  Std. Error  z value  Pr(&gt;|z|)
#&gt; (Intercept)     1.89816218  0.22759605   8.3400 &lt; 2.2e-16
#&gt; CRIM           -0.00571021  0.00093504  -6.1069 1.016e-09
#&gt; ZN              0.00069091  0.00051869   1.3320  0.182851
#&gt; INDUS          -0.00111343  0.00307354  -0.3623  0.717155
#&gt; CHAS1          -0.04163225  0.02739364  -1.5198  0.128567
#&gt; I(NOX^2)       -0.01034950  0.19360214  -0.0535  0.957367
#&gt; I(RM^2)         0.00794979  0.00102063   7.7891 6.661e-15
#&gt; AGE            -0.00128789  0.00048920  -2.6326  0.008473
#&gt; log(DIS)       -0.12404108  0.09510940  -1.3042  0.192168
#&gt; log(RAD)        0.05863502  0.02257078   2.5978  0.009382
#&gt; TAX            -0.00049084  0.00012145  -4.0416 5.308e-05
#&gt; PTRATIO        -0.01319853  0.00595352  -2.2169  0.026628
#&gt; B               0.00056383  0.00011089   5.0847 3.682e-07
#&gt; log(LSTAT)     -0.24724454  0.02262033 -10.9302 &lt; 2.2e-16
#&gt; lag.CRIM       -0.00464215  0.00172935  -2.6843  0.007267
#&gt; lag.ZN         -0.00037937  0.00070584  -0.5375  0.590940
#&gt; lag.INDUS       0.00025064  0.00385901   0.0649  0.948215
#&gt; lag.CHAS1       0.12518252  0.04071559   3.0746  0.002108
#&gt; lag.I(NOX^2)   -0.38640401  0.22157523  -1.7439  0.081177
#&gt; lag.I(RM^2)    -0.00451252  0.00153180  -2.9459  0.003220
#&gt; lag.AGE         0.00149678  0.00068418   2.1877  0.028693
#&gt; lag.log(DIS)   -0.00453785  0.10046478  -0.0452  0.963973
#&gt; lag.log(RAD)   -0.00940702  0.03104930  -0.3030  0.761912
#&gt; lag.TAX         0.00041083  0.00017867   2.2994  0.021481
#&gt; lag.PTRATIO     0.00060355  0.00788837   0.0765  0.939012
#&gt; lag.B          -0.00050781  0.00014155  -3.5874  0.000334
#&gt; lag.log(LSTAT)  0.09846781  0.03399423   2.8966  0.003772
#&gt; 
#&gt; Rho: 0.59578, LR test value: 181.68, p-value: &lt; 2.22e-16
#&gt; Asymptotic standard error: 0.038445
#&gt;     z-value: 15.497, p-value: &lt; 2.22e-16
#&gt; Wald statistic: 240.16, p-value: &lt; 2.22e-16
#&gt; 
#&gt; Log likelihood: 300.6131 for mixed model
#&gt; ML residual variance (sigma squared): 0.016011, (sigma: 0.12654)
#&gt; Number of observations: 506 
#&gt; Number of parameters estimated: 29 
#&gt; AIC: -543.23, (AIC for lm: -363.55)
#&gt; LM test for residual autocorrelation
#&gt; test value: 29.772, p-value: 4.8604e-08
#&gt; </div><div class='input'><span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>boston.soi</span>), <span class='st'>"CsparseMatrix"</span>)
<span class='no'>trMatb</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='trW.html'>trW</a></span>(<span class='no'>W</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mult"</span>)
<span class='no'>gp2mMi</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>CMEDV</span>) ~ <span class='no'>CRIM</span> + <span class='no'>ZN</span> + <span class='no'>INDUS</span> + <span class='no'>CHAS</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='no'>NOX</span>^<span class='fl'>2</span>) +
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/AsIs'>I</a></span>(<span class='no'>RM</span>^<span class='fl'>2</span>) +  <span class='no'>AGE</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>DIS</span>) + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>RAD</span>) + <span class='no'>TAX</span> + <span class='no'>PTRATIO</span> + <span class='no'>B</span> + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>LSTAT</span>),
<span class='kw'>data</span><span class='kw'>=</span><span class='no'>boston.c</span>, <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>boston.soi</span>), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mixed"</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"Matrix"</span>,
<span class='kw'>trs</span><span class='kw'>=</span><span class='no'>trMatb</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>gp2mMi</span>)</div><div class='output co'>#&gt; 
#&gt; Call:lagsarlm(formula = log(CMEDV) ~ CRIM + ZN + INDUS + CHAS + I(NOX^2) + 
#&gt;     I(RM^2) + AGE + log(DIS) + log(RAD) + TAX + PTRATIO + B + 
#&gt;     log(LSTAT), data = boston.c, listw = nb2listw(boston.soi), 
#&gt;     type = "mixed", method = "Matrix", trs = trMatb)
#&gt; 
#&gt; Residuals:
#&gt;        Min         1Q     Median         3Q        Max 
#&gt; -0.6316833 -0.0629790 -0.0090776  0.0682421  0.6991072 
#&gt; 
#&gt; Type: mixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;                   Estimate  Std. Error  z value  Pr(&gt;|z|)
#&gt; (Intercept)     1.89816218  0.22759605   8.3400 &lt; 2.2e-16
#&gt; CRIM           -0.00571021  0.00093504  -6.1069 1.016e-09
#&gt; ZN              0.00069091  0.00051869   1.3320  0.182851
#&gt; INDUS          -0.00111343  0.00307354  -0.3623  0.717155
#&gt; CHAS1          -0.04163225  0.02739364  -1.5198  0.128567
#&gt; I(NOX^2)       -0.01034950  0.19360214  -0.0535  0.957367
#&gt; I(RM^2)         0.00794979  0.00102063   7.7891 6.661e-15
#&gt; AGE            -0.00128789  0.00048920  -2.6326  0.008473
#&gt; log(DIS)       -0.12404108  0.09510940  -1.3042  0.192168
#&gt; log(RAD)        0.05863502  0.02257078   2.5978  0.009382
#&gt; TAX            -0.00049084  0.00012145  -4.0416 5.308e-05
#&gt; PTRATIO        -0.01319853  0.00595352  -2.2169  0.026628
#&gt; B               0.00056383  0.00011089   5.0847 3.682e-07
#&gt; log(LSTAT)     -0.24724454  0.02262033 -10.9302 &lt; 2.2e-16
#&gt; lag.CRIM       -0.00464215  0.00172935  -2.6843  0.007267
#&gt; lag.ZN         -0.00037937  0.00070584  -0.5375  0.590940
#&gt; lag.INDUS       0.00025064  0.00385901   0.0649  0.948215
#&gt; lag.CHAS1       0.12518252  0.04071559   3.0746  0.002108
#&gt; lag.I(NOX^2)   -0.38640401  0.22157523  -1.7439  0.081177
#&gt; lag.I(RM^2)    -0.00451252  0.00153180  -2.9459  0.003220
#&gt; lag.AGE         0.00149678  0.00068418   2.1877  0.028693
#&gt; lag.log(DIS)   -0.00453785  0.10046478  -0.0452  0.963973
#&gt; lag.log(RAD)   -0.00940702  0.03104930  -0.3030  0.761912
#&gt; lag.TAX         0.00041083  0.00017867   2.2994  0.021481
#&gt; lag.PTRATIO     0.00060355  0.00788837   0.0765  0.939012
#&gt; lag.B          -0.00050781  0.00014155  -3.5874  0.000334
#&gt; lag.log(LSTAT)  0.09846781  0.03399423   2.8966  0.003772
#&gt; 
#&gt; Rho: 0.59578, LR test value: 181.68, p-value: &lt; 2.22e-16
#&gt; Asymptotic standard error: 0.038445
#&gt;     z-value: 15.497, p-value: &lt; 2.22e-16
#&gt; Wald statistic: 240.16, p-value: &lt; 2.22e-16
#&gt; 
#&gt; Log likelihood: 300.6131 for mixed model
#&gt; ML residual variance (sigma squared): 0.016011, (sigma: 0.12654)
#&gt; Number of observations: 506 
#&gt; Number of parameters estimated: 29 
#&gt; AIC: -543.23, (AIC for lm: -363.55)
#&gt; LM test for residual autocorrelation
#&gt; test value: 29.772, p-value: 4.8604e-08
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>COL.lag.Bayes</span> <span class='kw'>&lt;-</span> <span class='fu'>spBreg_lag</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.lag.Bayes</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 501:2500
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 2000 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;                 Mean       SD Naive SE Time-series SE
#&gt; (Intercept)  45.8422  8.33297 0.186331       0.220103
#&gt; INC          -1.0460  0.35199 0.007871       0.008886
#&gt; HOVAL        -0.2675  0.09481 0.002120       0.002120
#&gt; rho           0.4174  0.12987 0.002904       0.003147
#&gt; sige        108.9668 24.59087 0.549869       0.579894
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;                2.5%     25%      50%      75%     97.5%
#&gt; (Intercept) 30.1130 40.3963  45.6116  51.2449  62.52518
#&gt; INC         -1.7618 -1.2684  -1.0386  -0.8170  -0.35564
#&gt; HOVAL       -0.4517 -0.3332  -0.2659  -0.2043  -0.08908
#&gt; rho          0.1536  0.3324   0.4197   0.5038   0.66183
#&gt; sige        71.2014 91.6918 105.3263 123.1005 165.01165
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.lag.Bayes</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>), <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (lag, trace):
#&gt;           Direct   Indirect      Total
#&gt; INC   -1.0970636 -0.6983134 -1.7953770
#&gt; HOVAL -0.2805878 -0.1786024 -0.4591902
#&gt; ========================================================
#&gt; MCMC sample impact results:
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;          Direct  Indirect     Total
#&gt; INC   0.3751705 0.5471652 0.8243027
#&gt; HOVAL 0.1015673 0.1463852 0.2238372
#&gt; 
#&gt; Simulated z-values:
#&gt;          Direct  Indirect     Total
#&gt; INC   -2.951364 -1.435134 -2.295904
#&gt; HOVAL -2.790347 -1.386199 -2.172682
#&gt; 
#&gt; Simulated p-values:
#&gt;       Direct    Indirect Total   
#&gt; INC   0.0031637 0.15125  0.021681
#&gt; HOVAL 0.0052652 0.16569  0.029804</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.lag.Bayes</span>, <span class='kw'>evalues</span><span class='kw'>=</span><span class='no'>ev</span>), <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (lag, evalues):
#&gt;           Direct   Indirect      Total
#&gt; INC   -1.0970636 -0.6983134 -1.7953770
#&gt; HOVAL -0.2805878 -0.1786024 -0.4591902
#&gt; ========================================================
#&gt; MCMC sample impact results:
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;          Direct  Indirect     Total
#&gt; INC   0.3751709 0.5472321 0.8243543
#&gt; HOVAL 0.1015676 0.1464146 0.2238607
#&gt; 
#&gt; Simulated z-values:
#&gt;          Direct  Indirect     Total
#&gt; INC   -2.951362 -1.434984 -2.295779
#&gt; HOVAL -2.790341 -1.385952 -2.172475
#&gt; 
#&gt; Simulated p-values:
#&gt;       Direct    Indirect Total   
#&gt; INC   0.0031638 0.15129  0.021689
#&gt; HOVAL 0.0052653 0.16576  0.029820</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>COL.D0.Bayes</span> <span class='kw'>&lt;-</span> <span class='fu'>spBreg_lag</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.D0.Bayes</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 501:2500
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 2000 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;                 Mean       SD Naive SE Time-series SE
#&gt; (Intercept)  45.6552 13.92684 0.311414       0.311414
#&gt; INC          -0.9357  0.37241 0.008327       0.008397
#&gt; HOVAL        -0.2916  0.09815 0.002195       0.002038
#&gt; lag.INC      -0.6098  0.61022 0.013645       0.013645
#&gt; lag.HOVAL     0.2458  0.18971 0.004242       0.004734
#&gt; rho           0.3883  0.16462 0.003681       0.003681
#&gt; sige        108.6633 25.45638 0.569222       0.655387
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;                 2.5%     25%      50%      75%    97.5%
#&gt; (Intercept) 19.42270 36.0252  45.3814  55.2111  73.4654
#&gt; INC         -1.66848 -1.1944  -0.9352  -0.6836  -0.1840
#&gt; HOVAL       -0.48299 -0.3576  -0.2930  -0.2232  -0.1015
#&gt; lag.INC     -1.85700 -1.0306  -0.5826  -0.1992   0.5816
#&gt; lag.HOVAL   -0.12660  0.1229   0.2465   0.3739   0.6106
#&gt; rho          0.05948  0.2706   0.3962   0.5040   0.6979
#&gt; sige        70.62697 90.7192 104.5505 123.4942 169.7947
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.D0.Bayes</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>), <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (mixed, trace):
#&gt;           Direct   Indirect       Total
#&gt; INC   -1.0389664 -1.4874152 -2.52638157
#&gt; HOVAL -0.2775359  0.2026609 -0.07487497
#&gt; ========================================================
#&gt; MCMC sample impact results:
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;          Direct  Indirect     Total
#&gt; INC   0.3927953 1.3104789 1.4692286
#&gt; HOVAL 0.1014637 0.3249945 0.3616705
#&gt; 
#&gt; Simulated z-values:
#&gt;          Direct   Indirect      Total
#&gt; INC   -2.700710 -1.2936313 -1.8758840
#&gt; HOVAL -2.749323  0.6152303 -0.2184584
#&gt; 
#&gt; Simulated p-values:
#&gt;       Direct    Indirect Total   
#&gt; INC   0.0069192 0.19579  0.060671
#&gt; HOVAL 0.0059718 0.53840  0.827072</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>COL.D1.Bayes</span> <span class='kw'>&lt;-</span> <span class='fu'>spBreg_lag</span>(<span class='no'>CRIME</span> ~ <span class='no'>DISCBD</span> + <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span> ~ <span class='no'>INC</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>COL.D1.Bayes</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 501:2500
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 2000 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;                 Mean      SD Naive SE Time-series SE
#&gt; (Intercept)  56.7873 13.5871 0.303817       0.303817
#&gt; DISCBD       -4.7577  2.0863 0.046652       0.044748
#&gt; INC          -0.9431  0.3481 0.007784       0.007784
#&gt; HOVAL        -0.1795  0.1008 0.002255       0.002255
#&gt; lag.INC       0.4036  0.6071 0.013575       0.012161
#&gt; rho           0.1821  0.1832 0.004095       0.004095
#&gt; sige        102.7442 23.7839 0.531824       0.608744
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;                2.5%       25%     50%      75%     97.5%
#&gt; (Intercept) 30.4765 47.703086 56.7720  65.3671  84.50212
#&gt; DISCBD      -8.8651 -6.222039 -4.6800  -3.3613  -0.61213
#&gt; INC         -1.6560 -1.156154 -0.9413  -0.7174  -0.28960
#&gt; HOVAL       -0.3748 -0.245735 -0.1811  -0.1107   0.01867
#&gt; lag.INC     -0.8123  0.003337  0.4135   0.8014   1.58038
#&gt; rho         -0.2147  0.062531  0.1826   0.3027   0.53984
#&gt; sige        67.4492 85.860315 98.7754 116.5171 159.56314
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.D1.Bayes</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>), <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (mixed, trace):
#&gt;            Direct    Indirect      Total
#&gt; DISCBD -4.7952447 -1.02140655 -5.8166512
#&gt; INC    -0.9330808  0.27348153 -0.6595992
#&gt; HOVAL  -0.1808675 -0.03852551 -0.2193930
#&gt; ========================================================
#&gt; MCMC sample impact results:
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;           Direct   Indirect     Total
#&gt; DISCBD 2.1324430 1.76669611 3.2740683
#&gt; INC    0.3521918 0.77882425 0.8652785
#&gt; HOVAL  0.1030000 0.07360172 0.1512414
#&gt; 
#&gt; Simulated z-values:
#&gt;           Direct   Indirect      Total
#&gt; DISCBD -2.272544 -0.7459585 -1.8826587
#&gt; INC    -2.669828  0.3187837 -0.7997599
#&gt; HOVAL  -1.775459 -0.6886619 -1.5442793
#&gt; 
#&gt; Simulated p-values:
#&gt;        Direct   Indirect Total   
#&gt; DISCBD 0.023054 0.45569  0.059747
#&gt; INC    0.007589 0.74989  0.423850
#&gt; HOVAL  0.075822 0.49104  0.122521</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>elect80</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"spData"</span>)
<span class='no'>lw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>e80_queen</span>, <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>el_ml</span> <span class='kw'>&lt;-</span> <span class='fu'>lagsarlm</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_turnout</span>) ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_college</span>) + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_homeownership</span>)
 + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_income</span>), <span class='kw'>data</span><span class='kw'>=</span><span class='no'>elect80</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>lw</span>, <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"LU"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>el_ml</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lagsarlm(formula = log(pc_turnout) ~ log(pc_college) + log(pc_homeownership) + 
#&gt;     log(pc_income), data = elect80, listw = lw, method = "LU", 
#&gt;     zero.policy = TRUE)
#&gt; 
#&gt; Residuals:
#&gt;        Min         1Q     Median         3Q        Max 
#&gt; -1.1132095 -0.0690070 -0.0037755  0.0670525  0.8084858 
#&gt; 
#&gt; Type: lag 
#&gt; Regions with no neighbours included:
#&gt;  1183 1189 1832 2945 
#&gt; Coefficients: (numerical Hessian approximate standard errors) 
#&gt;                        Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept)            0.637925   0.041787 15.2660 &lt; 2.2e-16
#&gt; log(pc_college)        0.226366   0.015759 14.3645 &lt; 2.2e-16
#&gt; log(pc_homeownership)  0.481409   0.014524 33.1464 &lt; 2.2e-16
#&gt; log(pc_income)        -0.104942   0.016550 -6.3408 2.285e-10
#&gt; 
#&gt; Rho: 0.57742, LR test value: 1085.5, p-value: &lt; 2.22e-16
#&gt; Approximate (numerical Hessian) standard error: 0.014966
#&gt;     z-value: 38.581, p-value: &lt; 2.22e-16
#&gt; Wald statistic: 1488.5, p-value: &lt; 2.22e-16
#&gt; 
#&gt; Log likelihood: 2132.772 for lag model
#&gt; ML residual variance (sigma squared): 0.013815, (sigma: 0.11754)
#&gt; Number of observations: 3107 
#&gt; Number of parameters estimated: 6 
#&gt; AIC: -4253.5, (AIC for lm: -3170)
#&gt; </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>el_B</span> <span class='kw'>&lt;-</span> <span class='fu'>spBreg_lag</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_turnout</span>) ~ <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_college</span>) + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_homeownership</span>)
 + <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>log</a></span>(<span class='no'>pc_income</span>), <span class='kw'>data</span><span class='kw'>=</span><span class='no'>elect80</span>, <span class='kw'>listw</span><span class='kw'>=</span><span class='no'>lw</span>, <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>el_B</span>)</div><div class='output co'>#&gt; 
#&gt; Iterations = 501:2500
#&gt; Thinning interval = 1 
#&gt; Number of chains = 1 
#&gt; Sample size per chain = 2000 
#&gt; 
#&gt; 1. Empirical mean and standard deviation for each variable,
#&gt;    plus standard error of the mean:
#&gt; 
#&gt;                           Mean        SD  Naive SE Time-series SE
#&gt; (Intercept)            0.63880 0.0412774 9.230e-04      8.895e-04
#&gt; log(pc_college)        0.22707 0.0162196 3.627e-04      3.627e-04
#&gt; log(pc_homeownership)  0.48157 0.0149993 3.354e-04      3.354e-04
#&gt; log(pc_income)        -0.10539 0.0164751 3.684e-04      3.684e-04
#&gt; rho                    0.57617 0.0152953 3.420e-04      3.420e-04
#&gt; sige                   0.01385 0.0003612 8.077e-06      8.077e-06
#&gt; 
#&gt; 2. Quantiles for each variable:
#&gt; 
#&gt;                           2.5%     25%      50%      75%    97.5%
#&gt; (Intercept)            0.55795  0.6113  0.63883  0.66694  0.71933
#&gt; log(pc_college)        0.19707  0.2163  0.22726  0.23783  0.25725
#&gt; log(pc_homeownership)  0.45325  0.4714  0.48133  0.49111  0.51015
#&gt; log(pc_income)        -0.13776 -0.1165 -0.10535 -0.09452 -0.07317
#&gt; rho                    0.54577  0.5658  0.57629  0.58679  0.60480
#&gt; sige                   0.01317  0.0136  0.01384  0.01410  0.01455
#&gt; </div><div class='input'><span class='no'>el_ml</span>$<span class='no'>timings</span></div><div class='output co'>#&gt;           user.self elapsed
#&gt; set_up        0.015   0.014
#&gt; LU_set_up     0.003   0.003
#&gt; LU_opt        0.243   0.247
#&gt; coefs         0.002   0.002
#&gt; LU_fdHess     0.335   0.340</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/attr'>attr</a></span>(<span class='no'>el_B</span>, <span class='st'>"timings"</span>)</div><div class='output co'>#&gt;                   user.self sys.self elapsed user.child sys.child
#&gt; set_up                0.011    0.000   0.012          0         0
#&gt; SE_classic_set_up     3.255    0.004   3.311          0         0
#&gt; complete_setup        0.000    0.000   0.000          0         0
#&gt; sampling              1.352    0.000   1.373          0         0
#&gt; finalise              0.013    0.000   0.014          0         0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#control-arguments">Control arguments</a></li>

      <li><a href="#extra-bayesian-control-arguments">Extra Bayesian control arguments</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a>, with thanks to Andrew 
Bernat for contributions to the asymptotic standard error code.</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

