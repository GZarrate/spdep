<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial simultaneous autoregressive SAC model estimation — sacsarlm • spdep</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Spatial simultaneous autoregressive SAC model estimation — sacsarlm" />

<meta property="og:description" content="Maximum likelihood estimation of spatial simultaneous autoregressive
&#8220;SAC/SARAR&#8221; models of the form:
$$y = \rho W1 y + X \beta + u, u = \lambda W2 u + \varepsilon$$
where \(\rho\) and \(\lambda\) are found by nlminb or optim() first, and \(\beta\) and other parameters by generalized least squares subsequently" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spdep</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/nb_igraph.html">Spatial weights objects as sparse matrices and graphs</a>
    </li>
    <li>
      <a href="../articles/nb_sf.html">Creating Neighbours using sf objects</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/spdep/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial simultaneous autoregressive SAC model estimation</h1>
    
    <div class="hidden name"><code>sacsarlm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Maximum likelihood estimation of spatial simultaneous autoregressive
&#8220;SAC/SARAR&#8221; models of the form:</p>
<p>$$y = \rho W1 y + X \beta + u, u = \lambda W2 u + \varepsilon$$</p>
<p>where \(\rho\) and \(\lambda\) are found by <code>nlminb</code> or <code>optim()</code> first, and \(\beta\) and other parameters by generalized least squares subsequently</p>
    
    </div>

    <pre class="usage"><span class='fu'>sacsarlm</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='no'>listw</span>, <span class='kw'>listw2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>na.action</span>, <span class='no'>Durbin</span>, <span class='no'>type</span>,
 <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"eigen"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>zero.policy</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>tol.solve</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>,
 <span class='kw'>llprof</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>interval1</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>interval2</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>trs1</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>trs2</span><span class='kw'>=</span><span class='kw'>NULL</span>,
 <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'>list</span>())
<span class='fu'>spBreg_sac</span>(<span class='no'>formula</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='no'>listw</span>, <span class='kw'>listw2</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>na.action</span>,
    <span class='no'>Durbin</span>, <span class='no'>type</span>, <span class='kw'>zero.policy</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of the model to be fit. The details 
of model specification are given for <code>lm()</code></p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model. 
By default the variables are taken from the environment which the function 
is called</p></td>
    </tr>
    <tr>
      <th>listw</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code></p></td>
    </tr>
    <tr>
      <th>listw2</th>
      <td><p>a <code>listw</code> object created for example by <code>nb2listw</code>, if not given, set to the same spatial weights as the <code>listw</code> argument</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function (default <code>options("na.action")</code>), can also be <code>na.omit</code> or <code>na.exclude</code> with consequences for residuals and fitted values - in these cases the weights list will be subsetted to remove NAs in the data. It may be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations. Note that only weights lists created without using the glist argument to <code>nb2listw</code> may be subsetted.</p></td>
    </tr>
    <tr>
      <th>Durbin</th>
      <td><p>default FALSE (SARAR model); if TRUE, full spatial general nested (Manski) model; if a formula object, the subset of explanatory variables to lag</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>(use the &#8216;Durbin=&#8217; argument - retained for backwards compatibility only) default "sac", may be set to "sacmixed" for the spatial general nested (Manski) model to include the spatially lagged independent variables added to X using <code>listw</code>; when "sacmixed", the lagged intercept is dropped for spatial weights style "W", that is row-standardised weights, but otherwise included</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>"eigen" (default) - the Jacobian is computed as the product 
of (1 - rho*eigenvalue) using <code>eigenw</code>, and "spam" or "Matrix" for strictly symmetric weights lists of styles "B" and "C", or made symmetric by similarity (Ord, 1975, Appendix C) if possible for styles "W" and "S", using code from the spam or Matrix packages to calculate the determinant; "LU" provides an alternative sparse matrix decomposition approach. In addition, there are "Chebyshev" and Monte Carlo "MC" approximate log-determinant methods.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>default NULL, use !verbose global option value; if FALSE, reports function values during optimization.</p></td>
    </tr>
    <tr>
      <th>zero.policy</th>
      <td><p>default NULL, use global option value; if TRUE assign zero to the lagged value of zones without 
neighbours, if FALSE (default) assign NA - causing <code>sacsarlm()</code> to terminate with an error</p></td>
    </tr>
    <tr>
      <th>tol.solve</th>
      <td><p>the tolerance for detecting linear dependencies in the columns of matrices to be inverted - passed to <code>solve()</code> (default=1.0e-10). This may be used if necessary to extract coefficient standard errors (for instance lowering to 1e-12), but errors in <code>solve()</code> may constitute indications of poorly scaled variables: if the variables have scales differing much from the autoregressive coefficient, the values in this matrix may be very different in scale, and inverting such a matrix is analytically possible by definition, but numerically unstable; rescaling the RHS variables alleviates this better than setting tol.solve to a very small value</p></td>
    </tr>
    <tr>
      <th>llprof</th>
      <td><p>default NULL, can either be an integer, to divide the feasible ranges into a grid of points, or a two-column matrix of spatial coefficient values, at which to evaluate the likelihood function</p></td>
    </tr>
    <tr>
      <th>trs1, trs2</th>
      <td><p>default NULL, if given, vectors for each weights object of powered spatial weights matrix traces output by <code>trW</code>; when given, used in some Jacobian methods</p></td>
    </tr>
    <tr>
      <th>interval1, interval2</th>
      <td><p>default is NULL, search intervals for each weights object for autoregressive parameters</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>list of extra control arguments - see section below</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Because numerical optimisation is used to find the values of lambda and rho, care needs to be shown. It has been found that the surface of the 2D likelihood function often forms a &#8220;banana trench&#8221; from (low rho, high lambda) through (high rho, high lambda) to (high rho, low lambda) values. In addition, sometimes the banana has optima towards both ends, one local, the other global, and conseqently the choice of the starting point for the final optimization becomes crucial. The default approach is not to use just (0, 0) as a starting point, nor the (rho, lambda) values from <code>gstsls</code>, which lie in a central part of the &#8220;trench&#8221;, but either four values at (low rho, high lambda), (0, 0), (high rho, high lambda), and (high rho, low lambda), and to use the best of these start points for the final optimization. Optionally, nine points can be used spanning the whole (lower, upper) space.</p>
    
    <h2 class="hasAnchor" id="control-arguments"><a class="anchor" href="#control-arguments"></a>Control arguments</h2>

    <dl class='dl-horizontal'>
  <dt>fdHess:</dt><dd><p>default NULL, then set to (method != "eigen") internally; use <code>fdHess</code> to compute an approximate Hessian using finite differences when using sparse matrix methods with <code>fdHess</code> from <span class="pkg">nlme</span>; used to make a coefficient covariance matrix when the number of observations is large; may be turned off to save resources if need be</p></dd>
  <dt>LAPACK:</dt><dd><p>default FALSE; logical value passed to <code>qr</code> in the SSE log likelihood function</p></dd>
  <dt>Imult:</dt><dd><p>default 2; used for preparing the Cholesky decompositions for updating in the Jacobian function</p></dd>
  <dt>cheb_q:</dt><dd><p>default 5; highest power of the approximating polynomial for the Chebyshev approximation</p></dd>
  <dt>MC_p:</dt><dd><p>default 16; number of random variates</p></dd>
  <dt>MC_m:</dt><dd><p>default 30; number of products of random variates matrix and spatial weights matrix</p></dd>
  <dt>super:</dt><dd><p>default FALSE using a simplicial decomposition for the sparse Cholesky decomposition, if TRUE, use a supernodal decomposition</p></dd>
  <dt>opt_method:</dt><dd><p>default &#8220;nlminb&#8221;, may be set to &#8220;L-BFGS-B&#8221; to use box-constrained optimisation in <code>optim</code></p></dd>
  <dt>opt_control:</dt><dd><p>default <code>list()</code>, a control list to pass to <code>nlminb</code> or <code>optim</code></p></dd>
  <dt>pars:</dt><dd><p>default <code>NULL</code>, for which five trial starting values spanning the lower/upper range are tried and the best selected, starting values of \(\rho\) and \(\lambda\)</p></dd>
  <dt>npars</dt><dd><p>default integer <code>4L</code>, four trial points; if not default value, nine trial points</p></dd>
  <dt>pre_eig1, pre_eig2</dt><dd><p>default NULL; may be used to pass pre-computed vectors of eigenvalues</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="extra-bayesian-control-arguments"><a class="anchor" href="#extra-bayesian-control-arguments"></a>Extra Bayesian control arguments</h2>

    <dl class='dl-horizontal'>
  <dt>ldet_method</dt><dd><p>default &#8220;SE_classic&#8221;; equivalent to the <code>method</code> argument in <code>lagsarlm</code></p></dd>
  <dt>interval1</dt><dd><p>default <code>c(-1, 1)</code>; used unmodified or set internally by <code>jacobianSetup</code></p></dd>
  <dt>interval2</dt><dd><p>default <code>c(-1, 1)</code>; used unmodified or set internally by <code>jacobianSetup</code></p></dd>
  <dt>ndraw</dt><dd><p>default <code>2500L</code>; integer total number of draws</p></dd>
  <dt>nomit</dt><dd><p>default <code>500L</code>; integer total number of omitted burn-in draws</p></dd>
  <dt>thin</dt><dd><p>default <code>1L</code>; integer thinning proportion</p></dd>
  <dt>detval1</dt><dd><p>default <code>NULL</code>; not yet in use, precomputed matrix of log determinants</p></dd>
  <dt>detval2</dt><dd><p>default <code>NULL</code>; not yet in use, precomputed matrix of log determinants</p></dd>
  <dt>prior</dt><dd><p>a list with the following components:
    <dl class='dl-horizontal'>
      <dt>Tbeta</dt><dd><p>default <code>NULL</code>; values of the betas variance-covariance matrix, set to <code>diag(k)*1e+12</code> if <code>NULL</code></p></dd>
      <dt>c_beta</dt><dd><p>default <code>NULL</code>; values of the betas set to 0 if <code>NULL</code></p></dd>
      <dt>lambda</dt><dd><p>default <code>0.5</code>; value of the autoregressive coefficient</p></dd>
      <dt>rho</dt><dd><p>default <code>0.5</code>; value of the autoregressive coefficient</p></dd>
      <dt>sige</dt><dd><p>default <code>1</code>; value of the residual variance</p></dd>
      <dt>nu</dt><dd><p>default <code>0</code>; informative Gamma(nu,d0) prior on sige</p></dd>
      <dt>d0</dt><dd><p>default <code>0</code>; informative Gamma(nu,d0) prior on sige</p></dd>
      <dt>a1</dt><dd><p>default <code>1.01</code>; parameter for beta(a1,a2) prior on rho</p></dd>
      <dt>a2</dt><dd><p>default <code>1.01</code>; parameter for beta(a1,a2) prior on rho</p></dd>
      <dt>cc1</dt><dd><p>default <code>0.2</code>; initial tuning parameter for M-H sampling</p></dd>
      <dt>cc2</dt><dd><p>default <code>0.2</code>; initial tuning parameter for M-H sampling</p></dd>
    </dl></p></dd>
</dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list object of class <code>sarlm</code></p>
<dt>type</dt><dd><p>&#8220;sac&#8221; or &#8220;sacmixed&#8221;</p></dd>
  <dt>dvars</dt><dd><p>vector of length 2, numbers of columns in X and WX; if Durbin is given as a formula, the formula as attribute &#8220;f&#8221;, the indices of the included Wx as &#8220;inds&#8221;, and indices of added zero Wx coefficients as &#8220;zero_fill&#8221;</p></dd>
  <dt>rho</dt><dd><p>lag simultaneous autoregressive lag coefficient</p></dd>
  <dt>lambda</dt><dd><p>error simultaneous autoregressive error coefficient</p></dd>
  <dt>coefficients</dt><dd><p>GLS coefficient estimates</p></dd>
  <dt>rest.se</dt><dd><p>asymptotic standard errors if ase=TRUE, otherwise approximate numeriacal Hessian-based values</p></dd>
  <dt>ase</dt><dd><p>TRUE if method=eigen</p></dd>
  <dt>LL</dt><dd><p>log likelihood value at computed optimum</p></dd>
  <dt>s2</dt><dd><p>GLS residual variance</p></dd>
  <dt>SSE</dt><dd><p>sum of squared GLS errors</p></dd>
  <dt>parameters</dt><dd><p>number of parameters estimated</p></dd>
  <dt>logLik_lm.model</dt><dd><p>Log likelihood of the non-spatial linear model</p></dd>
  <dt>AIC_lm.model</dt><dd><p>AIC of the non-spatial linear model</p></dd>
%  \item{lm.model}{the \code{lm} object returned when estimating for \eqn{\rho=0}{rho=0}}
  <dt>method</dt><dd><p>the method used to calculate the Jacobian</p></dd>
  <dt>call</dt><dd><p>the call used to create this object</p></dd>
  <dt>residuals</dt><dd><p>GLS residuals</p></dd>
%  \item{lm.target}{the \code{lm} object returned for the GLS fit}
  <dt>tarX</dt><dd><p>model matrix of the GLS model</p></dd>
  <dt>tary</dt><dd><p>response of the GLS model</p></dd>
  <dt>y</dt><dd><p>response of the linear model for \(\rho=0\)</p></dd>
  <dt>X</dt><dd><p>model matrix of the linear model for \(\rho=0\)</p></dd>
  <dt>opt</dt><dd><p>object returned from numerical optimisation</p></dd>
  <dt>pars</dt><dd><p>starting parameter values for final optimization, either given or found by trial point evaluation</p></dd>
  <dt>mxs</dt><dd><p>if default input pars, optimal objective function values at trial points</p></dd>
  <dt>fitted.values</dt><dd><p>Difference between residuals and response variable</p></dd>
  <dt>se.fit</dt><dd><p>Not used yet</p></dd>
%  \item{formula}{model formula}
  <dt>rho.se</dt><dd><p>if ase=TRUE, the asymptotic standard error of \(\rho\), otherwise approximate numeriacal Hessian-based value</p></dd>
  <dt>lambda.se</dt><dd><p>if ase=TRUE, the asymptotic standard error of \(\lambda\)</p></dd>
  <dt>resvar</dt><dd><p>the asymptotic coefficient covariance matrix for (s2, rho, lambda, B)</p></dd>
  <dt>zero.policy</dt><dd><p>zero.policy for this model</p></dd>
  <dt>aliased</dt><dd><p>the aliased explanatory variables (if any)</p></dd>
  <dt>LLNullLlm</dt><dd><p>Log-likelihood of the null linear model</p></dd>
  <dt>fdHess</dt><dd><p>the numerical Hessian-based coefficient covariance matrix for (rho, lambda, B) if computed</p></dd>
  <dt>resvar</dt><dd><p>asymptotic coefficient covariance matrix</p></dd>
  <dt>optimHess</dt><dd><p>FALSE</p></dd>
  <dt>timings</dt><dd><p>processing timings</p></dd>
  <dt>na.action</dt><dd><p>(possibly) named vector of excluded or omitted observations if non-default na.action argument used</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Anselin, L. 1988 <em>Spatial econometrics: methods and models.</em>
(Dordrecht: Kluwer); LeSage J and RK Pace (2009) <em>Introduction to Spatial Econometrics</em>. CRC Press, Boca Raton.</p>
<p>Roger Bivand, Gianfranco Piras (2015). Comparing Implementations of Estimation Methods for Spatial Econometrics. <em>Journal of Statistical Software</em>, 63(18), 1-36. <a href='https://www.jstatsoft.org/v63/i18/'>https://www.jstatsoft.org/v63/i18/</a>.</p>
<p>Bivand, R. S., Hauke, J., and Kossowski, T. (2013). Computing the Jacobian in Gaussian spatial autoregressive models: An illustrated comparison of available methods. <em>Geographical Analysis</em>, 45(2), 150-179.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>lm</code>, <code><a href='lagsarlm.html'>lagsarlm</a></code>, <code><a href='errorsarlm.html'>errorsarlm</a></code>, 
<code><a href='summary.sarlm.html'>summary.sarlm</a></code>, <code><a href='eigenw.html'>eigenw</a></code>, <code><a href='impacts.sarlm.html'>impacts.sarlm</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>oldcol</span>)
<span class='no'>listw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nb2listw.html'>nb2listw</a></span>(<span class='no'>COL.nb</span>, <span class='kw'>style</span><span class='kw'>=</span><span class='st'>"W"</span>)
<span class='no'>ev</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eigenw.html'>eigenw</a></span>(<span class='no'>listw</span>)
<span class='no'>COL.sacW.eig</span> <span class='kw'>&lt;-</span> <span class='fu'>sacsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='no'>listw</span>,
 <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>pre_eig1</span><span class='kw'>=</span><span class='no'>ev</span>, <span class='kw'>pre_eig2</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'>summary</span>(<span class='no'>COL.sacW.eig</span>)</div><div class='output co'>#&gt; 
#&gt; Call:sacsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     control = list(pre_eig1 = ev, pre_eig2 = ev))
#&gt; 
#&gt; Residuals:
#&gt;       Min        1Q    Median        3Q       Max 
#&gt; -37.32081  -5.33662  -0.20219   6.59672  23.25604 
#&gt; 
#&gt; Type: sac 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value  Pr(&gt;|z|)
#&gt; (Intercept) 47.783766   9.902659  4.8253 1.398e-06
#&gt; INC         -1.025894   0.326326 -3.1438  0.001668
#&gt; HOVAL       -0.281651   0.090033 -3.1283  0.001758
#&gt; 
#&gt; Rho: 0.36807
#&gt; Asymptotic standard error: 0.19668
#&gt;     z-value: 1.8714, p-value: 0.061285
#&gt; Lambda: 0.16668
#&gt; Asymptotic standard error: 0.29661
#&gt;     z-value: 0.56196, p-value: 0.57415
#&gt; 
#&gt; LR test value: 10.285, p-value: 0.0058432
#&gt; 
#&gt; Log likelihood: -182.2348 for sac model
#&gt; ML residual variance (sigma squared): 95.604, (sigma: 9.7777)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 6 
#&gt; AIC: 376.47, (AIC for lm: 382.75)
#&gt; </div><div class='input'><span class='no'>W</span> <span class='kw'>&lt;-</span> <span class='fu'>as</span>(<span class='no'>listw</span>, <span class='st'>"CsparseMatrix"</span>)
<span class='no'>trMatc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='trW.html'>trW</a></span>(<span class='no'>W</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"mult"</span>)
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='fu'>summary</span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.sacW.eig</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>2000</span>), <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (sac, trace):
#&gt;           Direct   Indirect      Total
#&gt; INC   -1.0632723 -0.5601501 -1.6234224
#&gt; HOVAL -0.2919129 -0.1537847 -0.4456977
#&gt; ========================================================
#&gt; Simulation results (asymptotic variance matrix):
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;           Direct  Indirect     Total
#&gt; INC   0.33545419 0.8259757 0.9596524
#&gt; HOVAL 0.09455759 0.2948444 0.3429655
#&gt; 
#&gt; Simulated z-values:
#&gt;          Direct   Indirect     Total
#&gt; INC   -3.234638 -0.8809213 -1.888905
#&gt; HOVAL -3.151908 -0.7356938 -1.501469
#&gt; 
#&gt; Simulated p-values:
#&gt;       Direct    Indirect Total   
#&gt; INC   0.0012180 0.37836  0.058905
#&gt; HOVAL 0.0016221 0.46192  0.133234</div><span class='co'># NOT RUN {</span>
<span class='kw'>if</span> (<span class='fu'>require</span>(<span class='no'>coda</span>, <span class='kw'>quietly</span><span class='kw'>=</span><span class='fl'>TRUE</span>)) {
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='no'>COL.sacW.B0</span> <span class='kw'>&lt;-</span> <span class='fu'>spBreg_sac</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='no'>listw</span>,
 <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>ndraw</span><span class='kw'>=</span><span class='fl'>1500L</span>, <span class='kw'>nomit</span><span class='kw'>=</span><span class='fl'>500L</span>))
<span class='fu'>print</span>(<span class='fu'>summary</span>(<span class='no'>COL.sacW.B0</span>))
<span class='fu'>print</span>(<span class='fu'>summary</span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.sacW.B0</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>), <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='no'>COL.sacW.B1</span> <span class='kw'>&lt;-</span> <span class='fu'>spBreg_sac</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='no'>listw</span>,
 <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>ndraw</span><span class='kw'>=</span><span class='fl'>1500L</span>, <span class='kw'>nomit</span><span class='kw'>=</span><span class='fl'>500L</span>))
<span class='fu'>print</span>(<span class='fu'>summary</span>(<span class='no'>COL.sacW.B1</span>))
<span class='fu'>print</span>(<span class='fu'>summary</span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.sacW.B1</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>), <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
}
<span class='co'># }</span><div class='input'><span class='no'>COL.msacW.eig</span> <span class='kw'>&lt;-</span> <span class='fu'>sacsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='no'>listw</span>,
 <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"sacmixed"</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>pre_eig1</span><span class='kw'>=</span><span class='no'>ev</span>, <span class='kw'>pre_eig2</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'>summary</span>(<span class='no'>COL.msacW.eig</span>)</div><div class='output co'>#&gt; 
#&gt; Call:sacsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     type = "sacmixed", control = list(pre_eig1 = ev, pre_eig2 = ev))
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -37.8045  -6.5244  -0.2207   5.9944  22.8691 
#&gt; 
#&gt; Type: sacmixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)
#&gt; (Intercept) 50.92025   68.25721  0.7460 0.455664
#&gt; INC         -0.95072    0.44033 -2.1591 0.030841
#&gt; HOVAL       -0.28650    0.09994 -2.8667 0.004148
#&gt; lag.INC     -0.69261    1.69113 -0.4096 0.682132
#&gt; lag.HOVAL    0.20852    0.28702  0.7265 0.467546
#&gt; 
#&gt; Rho: 0.31557
#&gt; Asymptotic standard error: 0.9458
#&gt;     z-value: 0.33365, p-value: 0.73864
#&gt; Lambda: 0.15415
#&gt; Asymptotic standard error: 1.0643
#&gt;     z-value: 0.14484, p-value: 0.88484
#&gt; 
#&gt; LR test value: 12.07, p-value: 0.016837
#&gt; 
#&gt; Log likelihood: -181.3422 for sacmixed model
#&gt; ML residual variance (sigma squared): 93.149, (sigma: 9.6514)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 8 
#&gt; AIC: 378.68, (AIC for lm: 382.75)
#&gt; </div><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='fu'>summary</span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.msacW.eig</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>2000</span>), <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (sacmixed, trace):
#&gt;           Direct   Indirect      Total
#&gt; INC   -1.0317003 -1.3693141 -2.4010144
#&gt; HOVAL -0.2768608  0.1629265 -0.1139344
#&gt; ========================================================
#&gt; Simulation results (asymptotic variance matrix):
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;          Direct  Indirect     Total
#&gt; INC   0.3807629 2.1529818 2.3054491
#&gt; HOVAL 0.1152970 0.8552182 0.9203861
#&gt; 
#&gt; Simulated z-values:
#&gt;          Direct   Indirect      Total
#&gt; INC   -2.710051 -0.6815119 -1.0840272
#&gt; HOVAL -2.375243  0.1902374 -0.1207796
#&gt; 
#&gt; Simulated p-values:
#&gt;       Direct    Indirect Total  
#&gt; INC   0.0067273 0.49555  0.27835
#&gt; HOVAL 0.0175374 0.84912  0.90387</div><div class='input'><span class='no'>COL.msacW1.eig</span> <span class='kw'>&lt;-</span> <span class='fu'>sacsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>, <span class='no'>listw</span>,
 <span class='kw'>Durbin</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>pre_eig1</span><span class='kw'>=</span><span class='no'>ev</span>, <span class='kw'>pre_eig2</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'>summary</span>(<span class='no'>COL.msacW1.eig</span>)</div><div class='output co'>#&gt; 
#&gt; Call:sacsarlm(formula = CRIME ~ INC + HOVAL, data = COL.OLD, listw = listw, 
#&gt;     Durbin = TRUE, control = list(pre_eig1 = ev, pre_eig2 = ev))
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -37.8045  -6.5244  -0.2207   5.9944  22.8691 
#&gt; 
#&gt; Type: sacmixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)
#&gt; (Intercept) 50.92025   68.25721  0.7460 0.455664
#&gt; INC         -0.95072    0.44033 -2.1591 0.030841
#&gt; HOVAL       -0.28650    0.09994 -2.8667 0.004148
#&gt; lag.INC     -0.69261    1.69113 -0.4096 0.682132
#&gt; lag.HOVAL    0.20852    0.28702  0.7265 0.467546
#&gt; 
#&gt; Rho: 0.31557
#&gt; Asymptotic standard error: 0.9458
#&gt;     z-value: 0.33365, p-value: 0.73864
#&gt; Lambda: 0.15415
#&gt; Asymptotic standard error: 1.0643
#&gt;     z-value: 0.14484, p-value: 0.88484
#&gt; 
#&gt; LR test value: 12.07, p-value: 0.016837
#&gt; 
#&gt; Log likelihood: -181.3422 for sacmixed model
#&gt; ML residual variance (sigma squared): 93.149, (sigma: 9.6514)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 8 
#&gt; AIC: 378.68, (AIC for lm: 382.75)
#&gt; </div><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>1</span>)
<span class='fu'>summary</span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.msacW1.eig</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>2000</span>), <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (sacmixed, trace):
#&gt;           Direct   Indirect      Total
#&gt; INC   -1.0317003 -1.3693141 -2.4010144
#&gt; HOVAL -0.2768608  0.1629265 -0.1139344
#&gt; ========================================================
#&gt; Simulation results (asymptotic variance matrix):
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;          Direct  Indirect     Total
#&gt; INC   0.3807629 2.1529818 2.3054491
#&gt; HOVAL 0.1152970 0.8552182 0.9203861
#&gt; 
#&gt; Simulated z-values:
#&gt;          Direct   Indirect      Total
#&gt; INC   -2.710051 -0.6815119 -1.0840272
#&gt; HOVAL -2.375243  0.1902374 -0.1207796
#&gt; 
#&gt; Simulated p-values:
#&gt;       Direct    Indirect Total  
#&gt; INC   0.0067273 0.49555  0.27835
#&gt; HOVAL 0.0175374 0.84912  0.90387</div><div class='input'><span class='no'>COL.msacW2.eig</span> <span class='kw'>&lt;-</span> <span class='fu'>sacsarlm</span>(<span class='no'>CRIME</span> ~ <span class='no'>DISCBD</span> + <span class='no'>INC</span> + <span class='no'>HOVAL</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>COL.OLD</span>,
 <span class='no'>listw</span>, <span class='kw'>Durbin</span><span class='kw'>=</span> ~ <span class='no'>INC</span>, <span class='kw'>control</span><span class='kw'>=</span><span class='fu'>list</span>(<span class='kw'>pre_eig1</span><span class='kw'>=</span><span class='no'>ev</span>, <span class='kw'>pre_eig2</span><span class='kw'>=</span><span class='no'>ev</span>))
<span class='fu'>summary</span>(<span class='no'>COL.msacW2.eig</span>)</div><div class='output co'>#&gt; 
#&gt; Call:sacsarlm(formula = CRIME ~ DISCBD + INC + HOVAL, data = COL.OLD, 
#&gt;     listw = listw, Durbin = ~INC, control = list(pre_eig1 = ev, 
#&gt;         pre_eig2 = ev))
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -34.2794  -7.0786   1.0543   6.0019  17.8891 
#&gt; 
#&gt; Type: sacmixed 
#&gt; Coefficients: (asymptotic standard errors) 
#&gt;              Estimate Std. Error z value Pr(&gt;|z|)
#&gt; (Intercept) 74.064506  37.738937  1.9625 0.049699
#&gt; DISCBD      -5.707678   3.248629 -1.7569 0.078926
#&gt; INC         -0.900975   0.314996 -2.8603 0.004233
#&gt; HOVAL       -0.203399   0.092982 -2.1875 0.028705
#&gt; lag.INC      0.061568   0.926947  0.0664 0.947043
#&gt; 
#&gt; Rho: -0.077599
#&gt; Asymptotic standard error: 0.57955
#&gt;     z-value: -0.1339, p-value: 0.89348
#&gt; Lambda: 0.29646
#&gt; Asymptotic standard error: 0.51021
#&gt;     z-value: 0.58104, p-value: 0.56121
#&gt; 
#&gt; LR test value: 1.4982, p-value: 0.68269
#&gt; 
#&gt; Log likelihood: -178.963 for sacmixed model
#&gt; ML residual variance (sigma squared): 85.135, (sigma: 9.2269)
#&gt; Number of observations: 49 
#&gt; Number of parameters estimated: 8 
#&gt; AIC: 373.93, (AIC for lm: 369.42)
#&gt; </div><div class='input'><span class='fu'>summary</span>(<span class='fu'><a href='impacts.sarlm.html'>impacts</a></span>(<span class='no'>COL.msacW2.eig</span>, <span class='kw'>tr</span><span class='kw'>=</span><span class='no'>trMatc</span>, <span class='kw'>R</span><span class='kw'>=</span><span class='fl'>2000</span>), <span class='kw'>zstats</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; Impact measures (sacmixed, trace):
#&gt;            Direct   Indirect      Total
#&gt; DISCBD -5.7150801 0.41841708 -5.2966631
#&gt; INC    -0.9031729 0.12421194 -0.7789609
#&gt; HOVAL  -0.2036631 0.01491075 -0.1887524
#&gt; ========================================================
#&gt; Simulation results (asymptotic variance matrix):
#&gt; ========================================================
#&gt; Simulated standard errors
#&gt;           Direct  Indirect     Total
#&gt; DISCBD 3.2369649 5.4951520 5.6486738
#&gt; INC    0.3627111 2.0073024 2.1711143
#&gt; HOVAL  0.1048754 0.4887553 0.5425235
#&gt; 
#&gt; Simulated z-values:
#&gt;           Direct    Indirect      Total
#&gt; DISCBD -1.793118  0.03441804 -0.9940614
#&gt; INC    -2.422720  0.15135275 -0.2648119
#&gt; HOVAL  -2.081309 -0.22460039 -0.6046793
#&gt; 
#&gt; Simulated p-values:
#&gt;        Direct   Indirect Total  
#&gt; DISCBD 0.072954 0.97254  0.32019
#&gt; INC    0.015405 0.87970  0.79115
#&gt; HOVAL  0.037406 0.82229  0.54539</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#control-arguments">Control arguments</a></li>

      <li><a href="#extra-bayesian-control-arguments">Extra Bayesian control arguments</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Roger Bivand <a href='mailto:Roger.Bivand@nhh.no'>Roger.Bivand@nhh.no</a>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roger Bivand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

